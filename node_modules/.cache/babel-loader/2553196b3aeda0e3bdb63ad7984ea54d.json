{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Hernandez\\\\Documents\\\\DOCUMENTOS UNIVERSIDAD\\\\INGENIERIA DE SOFTWARE\\\\CampusComm\\\\src\\\\listingCard.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport { useAuthState } from \"react-firebase-hooks/auth\";\nimport firebase, { auth } from \"./firebase\";\nimport { useHistory } from \"react-router-dom\";\nimport { Box, Card, CardActionArea, CardContent, CardMedia, Divider, Grow, IconButton, makeStyles, Tooltip, Typography } from \"@material-ui/core\";\nimport { Chat, Edit, Favorite, FavoriteBorder } from \"@material-ui/icons\";\nimport { useDocumentData } from \"react-firebase-hooks/firestore\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    width: \"300px\"\n  },\n  icons: {},\n  soldText: {\n    color: theme.mode === \"dark\" ? \"white\" : \"black\",\n    position: \"absolute\",\n    top: \"30%\",\n    left: \"50%\",\n    webkitTransform: \"translate(-50%, -50%)\",\n    msTransform: \"translate(-50%, -50%)\",\n    transform: \"translate(-50%, -50%)\",\n    textAlign: \"center\",\n    opacity: 1\n  },\n  soldOverlay: {\n    borderRadius: \"4px\",\n    position: \"absolute\",\n    top: \"0\",\n    bottom: \"0\",\n    left: \"0\",\n    right: \"0\",\n    height: \"100%\",\n    width: \"100%\",\n    transition: \".5s ease\",\n    backgroundColor: theme.mode === \"dark\" ? \"rgba(0,0,0,0.5)\" : \"rgba(255,255,255,0.5)\"\n  }\n}));\nconst firestore = firebase.firestore();\n\nfunction HomeListingCard(props) {\n  _s();\n\n  let {\n    name,\n    price,\n    imgUrl,\n    seller,\n    description,\n    likedBy,\n    allPhotos,\n    categories,\n    createdAt,\n    sold\n  } = props.listingObj;\n  const classes = useStyles();\n  const history = useHistory();\n  const [user] = useAuthState(auth);\n  const date2 = new Date();\n  const diffTime = Math.abs(date2.getTime() / 1000 - createdAt.seconds);\n  const diffDays = Math.floor(diffTime / (60 * 60 * 24));\n  const [sellerDoc, loadingSellerDoc] = useDocumentData(firestore.collection(\"users\").doc(seller));\n  let liked = null;\n  if (user) liked = likedBy.includes(user.uid);\n\n  const likeItem = () => {\n    if (liked) {\n      unlikeItem();\n      return;\n    }\n\n    if (user) {\n      firestore.collection(\"listings\").doc(props.iD).update({\n        likedBy: firebase.firestore.FieldValue.arrayUnion(user.uid)\n      });\n    }\n\n    liked = true;\n  };\n\n  const unlikeItem = () => {\n    if (user) {\n      firestore.collection(\"listings\").doc(props.iD).update(!sold ? {\n        likedBy: firebase.firestore.FieldValue.arrayRemove(user.uid)\n      } : {\n        likedBy: \"\"\n      });\n      firestore.collection(\"users\").doc(user.uid).update(!sold ? {\n        likes: firebase.firestore.FieldValue.arrayRemove(props.iD)\n      } : {\n        likedBy: \"\"\n      });\n    }\n\n    liked = false;\n  };\n\n  if (sold) unlikeItem();\n  price = parseFloat(price);\n  return /*#__PURE__*/_jsxDEV(Box, {\n    position: \"relative\",\n    children: /*#__PURE__*/_jsxDEV(Card, {\n      className: classes.root,\n      children: [/*#__PURE__*/_jsxDEV(CardActionArea, {\n        onClick: () => {\n          history.push({\n            pathname: \"/DisplayProduct\",\n            state: {\n              iD: props.iD\n            }\n          });\n        },\n        children: [/*#__PURE__*/_jsxDEV(CardMedia, {\n          component: \"img\",\n          height: \"200\",\n          image: imgUrl\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n          children: [/*#__PURE__*/_jsxDEV(Box, {\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              gutterBottom: true,\n              variant: \"h5\",\n              component: \"h4\",\n              display: \"inline\",\n              noWrap: true,\n              children: name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(Typography, {\n              gutterBottom: true,\n              variant: \"subtitle1\",\n              component: \"h3\",\n              display: \"inline\",\n              align: \"right\",\n              children: price === 0 || price === \"0\" ? \"FREE\" : \"£\" + price.toFixed(2)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Divider, {\n            variant: \"middle\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Box, {\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            children: /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"body2\",\n              color: \"textSecondary\",\n              component: \"p\",\n              noWrap: true,\n              style: {\n                marginTop: \"10px\"\n              },\n              children: description !== \"\" ? description : \"No description provided...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        display: \"flex\",\n        justifyContent: \"space-between\",\n        alignItems: \"center\",\n        children: [/*#__PURE__*/_jsxDEV(Box, {\n          display: \"flex\",\n          justifyContent: \"flex-start\",\n          alignItems: \"center\",\n          style: {\n            marginLeft: \"15px\"\n          },\n          children: /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"body2\",\n            color: \"textSecondary\",\n            component: \"p\",\n            noWrap: true,\n            children: diffDays === 0 ? \"Added today\" : diffDays === 1 ? \"Added Yesterday\" : `Added ${diffDays} days ago.`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          display: \"flex\",\n          justifyContent: \"flex-end\",\n          className: classes.icons,\n          alignItems: \"center\",\n          children: [/*#__PURE__*/_jsxDEV(Tooltip, {\n            title: user && seller === user.uid ? \"Edit your listing\" : \"Message seller\",\n            children: /*#__PURE__*/_jsxDEV(IconButton, {\n              onClick: () => {\n                user && seller === user.uid ? history.push({\n                  pathname: \"/Product\",\n                  state: {\n                    iDListing: props.iD,\n                    name: name,\n                    description: description,\n                    price: price,\n                    url: imgUrl,\n                    extraUrls: allPhotos,\n                    categories: categories\n                  }\n                }) : user ? history.push({\n                  pathname: \"/ChatRoom\",\n                  state: {\n                    targetUserID: seller,\n                    targetUserName: sellerDoc.Name,\n                    myUID: user.uid,\n                    interestedProduct: name\n                  }\n                }) : history.push(\"/menu\");\n              },\n              children: user && seller === user.uid ? /*#__PURE__*/_jsxDEV(Edit, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 56\n              }, this) : /*#__PURE__*/_jsxDEV(Chat, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 66\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n            title: liked ? \"Remove from favourites\" : \"Add to favourites\",\n            children: /*#__PURE__*/_jsxDEV(IconButton, {\n              onClick: () => {\n                likeItem();\n              },\n              children: user && likedBy.includes(user.uid) ? /*#__PURE__*/_jsxDEV(Grow, {\n                in: user && likedBy.includes(user.uid),\n                children: /*#__PURE__*/_jsxDEV(Favorite, {\n                  color: \"error\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 182,\n                  columnNumber: 75\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 182,\n                columnNumber: 29\n              }, this) : /*#__PURE__*/_jsxDEV(FavoriteBorder, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 183,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        className: sold ? classes.soldOverlay : \"\",\n        children: /*#__PURE__*/_jsxDEV(Box, {\n          className: classes.soldText,\n          children: sold ? /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"h5\",\n            style: {\n              fontSize: \"25px\"\n            },\n            children: /*#__PURE__*/_jsxDEV(Box, {\n              fontWeight: \"fontWeightBold\",\n              children: \"Lo sentimos, este listado ya no est\\xE1 disponible\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 25\n          }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 102,\n    columnNumber: 9\n  }, this);\n}\n\n_s(HomeListingCard, \"obHOAAY3Vi2vmborz93Rv1Bttkk=\", false, function () {\n  return [useStyles, useHistory, useAuthState, useDocumentData];\n});\n\n_c = HomeListingCard;\nexport default HomeListingCard;\n\nvar _c;\n\n$RefreshReg$(_c, \"HomeListingCard\");","map":{"version":3,"sources":["C:/Users/Hernandez/Documents/DOCUMENTOS UNIVERSIDAD/INGENIERIA DE SOFTWARE/CampusComm/src/listingCard.js"],"names":["React","useAuthState","firebase","auth","useHistory","Box","Card","CardActionArea","CardContent","CardMedia","Divider","Grow","IconButton","makeStyles","Tooltip","Typography","Chat","Edit","Favorite","FavoriteBorder","useDocumentData","useStyles","theme","root","width","icons","soldText","color","mode","position","top","left","webkitTransform","msTransform","transform","textAlign","opacity","soldOverlay","borderRadius","bottom","right","height","transition","backgroundColor","firestore","HomeListingCard","props","name","price","imgUrl","seller","description","likedBy","allPhotos","categories","createdAt","sold","listingObj","classes","history","user","date2","Date","diffTime","Math","abs","getTime","seconds","diffDays","floor","sellerDoc","loadingSellerDoc","collection","doc","liked","includes","uid","likeItem","unlikeItem","iD","update","FieldValue","arrayUnion","arrayRemove","likes","parseFloat","push","pathname","state","toFixed","marginTop","marginLeft","iDListing","url","extraUrls","targetUserID","targetUserName","Name","myUID","interestedProduct","fontSize"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport {useAuthState} from \"react-firebase-hooks/auth\";\nimport firebase, {auth} from \"./firebase\";\nimport {useHistory} from \"react-router-dom\";\nimport {\n    Box,\n    Card,\n    CardActionArea,\n    CardContent,\n    CardMedia,\n    Divider,\n    Grow,\n    IconButton,\n    makeStyles,\n    Tooltip,\n    Typography\n} from \"@material-ui/core\";\nimport {Chat, Edit, Favorite, FavoriteBorder} from \"@material-ui/icons\";\nimport {useDocumentData} from \"react-firebase-hooks/firestore\";\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        width: \"300px\",\n    },\n    icons: {\n    },\n    soldText: {\n        color: (theme.mode === \"dark\" ? \"white\" : \"black\"),\n        position: \"absolute\",\n        top: \"30%\",\n        left: \"50%\",\n        webkitTransform: \"translate(-50%, -50%)\",\n        msTransform: \"translate(-50%, -50%)\",\n        transform: \"translate(-50%, -50%)\",\n        textAlign: \"center\",\n        opacity: 1,\n    },\n    soldOverlay: {\n        borderRadius: \"4px\", position: \"absolute\",\n        top: \"0\",\n        bottom: \"0\",\n        left: \"0\",\n        right: \"0\",\n        height: \"100%\",\n        width: \"100%\",\n        transition: \".5s ease\",\n        backgroundColor: (theme.mode === \"dark\" ? \"rgba(0,0,0,0.5)\" : \"rgba(255,255,255,0.5)\"),\n    }\n}))\n\nconst firestore = firebase.firestore();\n\nfunction HomeListingCard(props) {\n    let {name, price, imgUrl, seller, description, likedBy, allPhotos, categories, createdAt, sold} = props.listingObj\n    const classes = useStyles();\n    const history = useHistory();\n    const [user] = useAuthState(auth);\n\n    const date2 = new Date()\n    const diffTime = Math.abs((date2.getTime() / 1000) - createdAt.seconds);\n    const diffDays = Math.floor(diffTime / (60 * 60 * 24));\n\n\n    const [sellerDoc, loadingSellerDoc] = useDocumentData(firestore.collection(\"users\").doc(seller))\n\n    let liked = null;\n    if (user) liked = likedBy.includes(user.uid)\n\n\n    const likeItem = () => {\n        if (liked) {\n            unlikeItem();\n            return;\n        }\n        if (user) {\n            firestore.collection(\"listings\").doc(props.iD).update({\n                likedBy: firebase.firestore.FieldValue.arrayUnion(user.uid),\n            })\n        }\n        liked = true\n    }\n\n    const unlikeItem = () => {\n        if (user) {\n            firestore.collection(\"listings\").doc(props.iD).update(!sold ? {\n                likedBy: firebase.firestore.FieldValue.arrayRemove(user.uid),\n            } : {likedBy: \"\"})\n            firestore.collection(\"users\").doc(user.uid).update(!sold ? {\n                likes: firebase.firestore.FieldValue.arrayRemove(props.iD),\n            } : {likedBy: \"\"})\n\n        }\n        liked = false\n    }\n\n    if (sold) unlikeItem()\n    price = parseFloat(price)\n\n    return (\n   \n\n        <Box position=\"relative\">\n        <Card className={classes.root}>\n            <CardActionArea onClick={() => {\n                history.push({pathname: \"/DisplayProduct\", state: {iD: props.iD}})\n            }}>\n                <CardMedia\n                    component=\"img\"\n                    height=\"200\"\n                    image={imgUrl}\n                />\n                <CardContent>\n                    <Box display=\"flex\" justifyContent=\"space-between\">\n                        <Typography gutterBottom variant=\"h5\" component=\"h4\" display=\"inline\" noWrap>\n                            {name}\n                        </Typography>\n                        <Typography gutterBottom variant=\"subtitle1\" component=\"h3\" display=\"inline\" align=\"right\">\n                            {price === 0 || price === \"0\" ? \"FREE\" : \"£\" + price.toFixed(2)}\n                        </Typography>\n                    </Box>\n                    <Divider variant=\"middle\"/>\n                    <Box display=\"flex\" justifyContent=\"space-between\">\n                        <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\" noWrap\n                                    style={{marginTop: \"10px\"}}>\n                            {description !== \"\" ? description : \"No description provided...\"}\n                        </Typography>\n                    </Box>\n                </CardContent>\n\n            </CardActionArea>\n            <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\">\n            <Box display=\"flex\" justifyContent=\"flex-start\" alignItems=\"center\" style={{marginLeft: \"15px\"}}>\n                <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\" noWrap>\n\n                    {diffDays === 0 ?\n                        \"Added today\"\n                        :\n                        ( diffDays === 1 ?\n                            \"Added Yesterday\" :\n                            `Added ${diffDays} days ago.`\n                        )\n                    }\n                </Typography>\n            </Box>\n            <Box display=\"flex\" justifyContent=\"flex-end\" className={classes.icons} alignItems=\"center\">\n                <Tooltip title={user && seller === user.uid ? \"Edit your listing\" : \"Message seller\"}>\n                    <IconButton onClick={() => {\n                        user && seller === user.uid ?\n                            history.push({\n                                pathname: \"/Product\",\n                                state: {\n                                    iDListing: props.iD,\n                                    name: name,\n                                    description: description,\n                                    price: price,\n                                    url: imgUrl,\n                                    extraUrls: allPhotos,\n                                    categories: categories,\n                                },\n                            })\n                            : (user) ?\n                            (history.push({\n                                pathname: \"/ChatRoom\",\n                                state: {\n                                    targetUserID: seller,\n                                    targetUserName: sellerDoc.Name,\n                                    myUID: user.uid,\n                                    interestedProduct: name,\n                                },\n                            }))\n                            :\n                            history.push(\"/menu\")\n                    }}>\n                        {user && seller === user.uid ? <Edit/> : <Chat/>}\n                    </IconButton>\n                </Tooltip>\n                <Tooltip title={liked ? \"Remove from favourites\" : \"Add to favourites\"}>\n                    <IconButton onClick={() => {\n                        likeItem()\n                    }}>\n                        {user && likedBy.includes(user.uid) ?\n                            <Grow in={user && likedBy.includes(user.uid)}><Favorite color=\"error\"/></Grow> :\n                            <FavoriteBorder/>}\n                    </IconButton>\n                </Tooltip>\n            </Box>\n            </Box>\n            <Box className={(sold ? classes.soldOverlay : \"\")}>\n                <Box className={classes.soldText}>\n                    { sold ?\n                        <Typography variant=\"h5\" style={{fontSize: \"25px\"}}>\n                            <Box fontWeight=\"fontWeightBold\">\n                            Lo sentimos, este listado ya no está disponible\n                            </Box>\n                        </Typography>\n                        :\n                        <></>\n                    }\n                </Box>\n            </Box>\n\n        </Card>\n        </Box>\n\n    )\n}\n\nexport default HomeListingCard;"]},"metadata":{},"sourceType":"module"}