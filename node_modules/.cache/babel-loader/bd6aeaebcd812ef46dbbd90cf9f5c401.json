{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Hernandez\\\\Documents\\\\DOCUMENTOS UNIVERSIDAD\\\\INGENIERIA DE SOFTWARE\\\\CampusComm\\\\src\\\\DisplayProduct.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport firebase, { auth } from './firebase';\nimport { useCollection } from 'react-firebase-hooks/firestore';\nimport { useAuthState } from \"react-firebase-hooks/auth\";\nimport { useHistory } from 'react-router-dom';\nimport { Box, Button, Dialog, Divider, Grid, Paper, Typography } from \"@material-ui/core\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport red from \"@material-ui/core/colors/red\";\nimport emptyFrame from \"./img/emptyFrame.png\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst firestore = firebase.firestore();\nconst useStyles = makeStyles(theme => ({\n  container: {\n    margin: \"30px\",\n    marginBottom: \"100px\"\n  },\n  media: {\n    display: 'flex',\n    justifyContent: 'center',\n    objectFit: \"cover\"\n  },\n  noButton: {\n    color: theme.palette.action.disabled,\n    borderColor: theme.palette.action.disabled\n  },\n  yesButton: {\n    color: red[200],\n    borderColor: red[200]\n  },\n  secondPaper: {\n    backgroundColor: theme.palette.background.paper2\n  },\n  emptyFrame: {\n    width: \"120px\",\n    height: \"120px\"\n  },\n  smallImages: {\n    width: \"120px\",\n    height: \"120px\",\n    objectFit: \"cover\",\n    borderStyle: \"solid\",\n    borderColor: theme.palette.secondary.main,\n    borderWidth: \"2px\"\n  }\n}));\nvar globalID = null;\nvar globalUserID = null;\nvar sellerID = null;\nvar oldVal = \"\";\n\nfunction DisplayProduct(props) {\n  _s();\n\n  let id = props.location.state.iD;\n  globalID = id;\n  const [user] = useAuthState(auth);\n  var userID = null;\n  var match = false;\n  var msg = \"Loading\";\n  var gotoSeller = \"Loading\";\n\n  if (user != null) {\n    userID = user.uid;\n  }\n\n  globalUserID = userID;\n  const history = useHistory();\n  const classes = useStyles(); // Getting the listings from the database.\n\n  const listingsRef = firestore.collection('listings').doc(id);\n  var [document, loading] = useCollection(listingsRef);\n  var listingName = \"Loading\",\n      listingDes = \"Loading\",\n      listingPrice = \"Loading\",\n      listingSeller = \"Loading\",\n      listingTags = [];\n  var listingUrl = [];\n  var userName = \"Loading\";\n  var myListing = null;\n  var path = \"\";\n  var userPath = \"\";\n  var state = [];\n  var stateMyProduct = [];\n  var stateMsg = [];\n  var sold = false;\n  var listingExtraUrls = [];\n  var allImages = [];\n\n  if (!loading && (myListing = document.data()) !== undefined) {\n    listingName = myListing.name;\n    listingDes = myListing.description;\n    listingSeller = myListing.seller;\n    listingPrice = myListing.price;\n    listingUrl = [myListing.imgUrl];\n    listingTags = myListing.categories;\n    listingExtraUrls = myListing.allPhotos;\n    oldVal = myListing.interestedUsers;\n    allImages = listingUrl.concat(listingExtraUrls);\n    if (oldVal == null) oldVal = \"\";\n    sold = myListing.sold;\n    if (sold == null) sold = \"false\";\n  } else {}\n\n  var userRef = firestore.collection('users').where(\"ID\", \"==\", listingSeller);\n  var [trueSeller, loadingSeller] = useCollection(userRef);\n  var SellerID;\n\n  if (!loadingSeller) {\n    trueSeller.forEach(seller => {\n      userName = seller.data().Name;\n      SellerID = seller.data().ID;\n      sellerID = SellerID;\n    });\n  }\n\n  if (listingSeller == userID) {\n    msg = \"Edit details\";\n    gotoSeller = \"Go to My Profile\";\n    match = true;\n    path = \"/product\";\n    userPath = \"/Profile\";\n    stateMyProduct = {\n      iDListing: id,\n      name: listingName,\n      description: listingDes,\n      price: listingPrice,\n      url: listingUrl[0],\n      extraUrls: listingExtraUrls,\n      categories: listingTags\n    };\n    state = {\n      targetUserID: SellerID,\n      currentUserID: userID\n    };\n  } else {\n    msg = \"Message Seller\";\n    gotoSeller = \"Go to Seller Profile\";\n    userPath = \"/Profile\";\n    path = \"/ChatRoom\";\n    stateMyProduct = {\n      targetUserName: userName,\n      targetUserID: SellerID,\n      myUID: userID,\n      interestedProduct: listingName\n    };\n    state = {\n      targetUserID: SellerID,\n      currentUserID: userID\n    };\n  }\n\n  const updateInterested = () => {\n    var newVal = \"\";\n\n    if (oldVal == null || oldVal == \"\") {\n      newVal = globalUserID;\n    } else {\n      if (oldVal.includes(globalUserID)) {\n        if (oldVal.includes(\",\" + globalUserID)) var toRemove = \",\" + globalUserID;else var toRemove = globalUserID;\n        newVal = oldVal.replace(toRemove, \"\");\n      } else {\n        newVal = oldVal + \",\" + globalUserID;\n      }\n    }\n\n    firestore.collection('listings').doc(globalID).update({\n      interestedUsers: newVal\n    });\n  };\n\n  function SimpleDialog(props) {\n    const {\n      onClose,\n      selectedValue,\n      open\n    } = props;\n\n    const handleClose = () => {\n      onClose(selectedValue);\n    };\n\n    return /*#__PURE__*/_jsxDEV(Dialog, {\n      onClose: handleClose,\n      \"aria-labelledby\": \"simple-dialog-title\",\n      open: open,\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        justifyContent: \"center\",\n        m: 1,\n        p: 1,\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: listingUrl,\n          alt: \"react logo\",\n          className: \"productImage\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 13\n    }, this);\n  }\n\n  const [open, setOpen] = React.useState(false);\n  const [selectedValue, setSelectedValue] = React.useState(listingUrl);\n  const [selectedImageIndex, setSelectedImageIndex] = useState(0);\n\n  function setBigImage(index) {\n    if (allImages[index] !== undefined) {\n      setSelectedImageIndex(index);\n    }\n  }\n\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = value => {\n    setOpen(false);\n    setSelectedValue(value);\n  };\n\n  let smallImages = [];\n\n  for (let i = 0; i < 6; ++i) {\n    smallImages.push( /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 6,\n      sm: 4,\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        p: 3,\n        display: \"flex\",\n        justifyContent: \"space-between\",\n        alignItems: \"center\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: allImages !== [] && allImages[i] !== undefined ? allImages[i] : emptyFrame,\n          className: allImages !== [] && allImages[i] !== undefined ? classes.smallImages : classes.emptyFrame,\n          style: {\n            borderRadius: `${i === selectedImageIndex ? \"16px\" : \"3px\"}`\n          },\n          onClick: () => {\n            setBigImage(i);\n          },\n          alt: \"Primary Image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 13\n    }, this));\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Box, {\n      p: 1,\n      m: 1,\n      className: classes.container,\n      children: /*#__PURE__*/_jsxDEV(Paper, {\n        children: [/*#__PURE__*/_jsxDEV(Box, {\n          p: 3,\n          display: \"flex\",\n          justifyContent: \"space-between\",\n          alignItems: \"center\",\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"h1\",\n            style: {\n              fontSize: 36,\n              display: 'inline-block'\n            },\n            children: listingName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"h2\",\n            style: {\n              fontSize: 28,\n              display: 'inline-block'\n            },\n            align: \"right\",\n            children: [\"\\xA3\", listingPrice]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(Divider, {\n          variant: \"middle\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          children: /*#__PURE__*/_jsxDEV(Grid, {\n            container: true,\n            spacing: 3,\n            children: [/*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 12,\n              md: 6,\n              lg: 4,\n              children: /*#__PURE__*/_jsxDEV(Box, {\n                p: 3,\n                display: \"flex\",\n                justifyContent: \"center\",\n                alignItems: \"center\",\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: allImages !== [] ? allImages[selectedImageIndex] : emptyFrame,\n                  style: {\n                    width: \"400px\",\n                    height: \"400px\",\n                    objectFit: \"scale-down\"\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 250,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 249,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 248,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 12,\n              md: 6,\n              lg: 4,\n              children: /*#__PURE__*/_jsxDEV(Box, {\n                display: \"flex\",\n                justifyContent: \"space-evenly\",\n                justifyItems: \"center\",\n                alignItems: \"center\",\n                flexWrap: \"wrap\",\n                children: /*#__PURE__*/_jsxDEV(Grid, {\n                  container: true,\n                  spacing: 1,\n                  children: smallImages\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 259,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 258,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 257,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              xs: 12,\n              lg: 4,\n              children: /*#__PURE__*/_jsxDEV(Box, {\n                display: \"flex\",\n                justifyContent: \"space-around\",\n                alignItems: \"center\",\n                flexWrap: \"wrap\",\n                m: 2,\n                p: 2,\n                children: /*#__PURE__*/_jsxDEV(Grid, {\n                  container: true,\n                  spacing: 4,\n                  children: [/*#__PURE__*/_jsxDEV(Grid, {\n                    item: true,\n                    xs: 12,\n                    children: /*#__PURE__*/_jsxDEV(Box, {\n                      display: \"flex\",\n                      justifyContent: \"center\",\n                      alignItems: \"center\",\n                      flexDirection: \"column\",\n                      children: [globalUserID !== sellerID ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                        children: sold === \"false\" ? /*#__PURE__*/_jsxDEV(Button, {\n                          onClick: updateInterested,\n                          variant: \"outlined\",\n                          color: \"primary\",\n                          children: oldVal.includes(globalUserID) ? \"Cancel request\" : \"Request to buy\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 273,\n                          columnNumber: 57\n                        }, this) : /*#__PURE__*/_jsxDEV(Typography, {\n                          variant: \"h2\",\n                          style: {\n                            fontSize: 24,\n                            marginBottom: \"10px\"\n                          },\n                          children: \"Sorry, this listing has been sold.\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 284,\n                          columnNumber: 57\n                        }, this)\n                      }, void 0, false) : /*#__PURE__*/_jsxDEV(Typography, {\n                        variant: \"h2\",\n                        style: {\n                          fontSize: 24,\n                          marginBottom: \"10px\"\n                        },\n                        children: \"Lo sentimos, no puedes comprar tu propio anuncio.\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 293,\n                        columnNumber: 53\n                      }, this), /*#__PURE__*/_jsxDEV(Button, {\n                        variant: \"outlined\",\n                        color: \"primary\",\n                        onClick: () => {\n                          history.push(path, stateMyProduct);\n                        },\n                        children: msg\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 300,\n                        columnNumber: 49\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 269,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 268,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                    item: true,\n                    xs: 12,\n                    children: /*#__PURE__*/_jsxDEV(Box, {\n                      display: \"flex\",\n                      justifyContent: \"center\",\n                      alignItems: \"center\",\n                      flexDirection: \"column\",\n                      children: [/*#__PURE__*/_jsxDEV(Typography, {\n                        variant: \"h2\",\n                        style: {\n                          fontSize: 24,\n                          marginBottom: \"10px\"\n                        },\n                        children: [\"Vendedor: \", userName]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 315,\n                        columnNumber: 49\n                      }, this), /*#__PURE__*/_jsxDEV(Button, {\n                        variant: \"outlined\",\n                        color: \"primary\",\n                        onClick: () => {\n                          history.push(userPath, state);\n                        },\n                        children: gotoSeller\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 321,\n                        columnNumber: 49\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 313,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 311,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 267,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 265,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(Divider, {\n          variant: \"middle\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          p: 3,\n          display: \"flex\",\n          justifyContent: \"space-between\",\n          alignItems: \"center\",\n          children: /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 12,\n            children: /*#__PURE__*/_jsxDEV(Paper, {\n              elevation: 3,\n              className: classes.secondPaper,\n              children: /*#__PURE__*/_jsxDEV(Box, {\n                p: 3,\n                children: [/*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"h2\",\n                  style: {\n                    fontSize: 24,\n                    marginBottom: \"10px\"\n                  },\n                  children: \"Descripcion:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 344,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(Divider, {\n                  variant: \"fullWidth\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 350,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                  variant: \"body2\",\n                  color: \"textSecondary\",\n                  style: {\n                    marginTop: \"10px\",\n                    whiteSpace: 'pre-line'\n                  },\n                  children: listingDes\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 351,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 343,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 342,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          p: 3,\n          children: [/*#__PURE__*/_jsxDEV(Box, {\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            alignItems: \"center\",\n            children: /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"body2\",\n              color: \"textSecondary\",\n              children: \"Tags:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 362,\n              columnNumber: 34\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 361,\n            columnNumber: 30\n          }, this), /*#__PURE__*/_jsxDEV(Box, {\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            alignItems: \"center\",\n            children: /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"body2\",\n              color: \"textSecondary\",\n              children: listingTags.join(\", \")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 368,\n              columnNumber: 30\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 30\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 26\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 13\n    }, this)\n  }, void 0, false);\n}\n\n_s(DisplayProduct, \"Pfq0VObQXPyjK9MLWn4mr+rnMuE=\", false, function () {\n  return [useAuthState, useHistory, useStyles, useCollection, useCollection];\n});\n\n_c = DisplayProduct;\nexport default DisplayProduct;\n\nvar _c;\n\n$RefreshReg$(_c, \"DisplayProduct\");","map":{"version":3,"sources":["C:/Users/Hernandez/Documents/DOCUMENTOS UNIVERSIDAD/INGENIERIA DE SOFTWARE/CampusComm/src/DisplayProduct.js"],"names":["React","useState","firebase","auth","useCollection","useAuthState","useHistory","Box","Button","Dialog","Divider","Grid","Paper","Typography","makeStyles","red","emptyFrame","firestore","useStyles","theme","container","margin","marginBottom","media","display","justifyContent","objectFit","noButton","color","palette","action","disabled","borderColor","yesButton","secondPaper","backgroundColor","background","paper2","width","height","smallImages","borderStyle","secondary","main","borderWidth","globalID","globalUserID","sellerID","oldVal","DisplayProduct","props","id","location","state","iD","user","userID","match","msg","gotoSeller","uid","history","classes","listingsRef","collection","doc","document","loading","listingName","listingDes","listingPrice","listingSeller","listingTags","listingUrl","userName","myListing","path","userPath","stateMyProduct","stateMsg","sold","listingExtraUrls","allImages","data","undefined","name","description","seller","price","imgUrl","categories","allPhotos","interestedUsers","concat","userRef","where","trueSeller","loadingSeller","SellerID","forEach","Name","ID","iDListing","url","extraUrls","targetUserID","currentUserID","targetUserName","myUID","interestedProduct","updateInterested","newVal","includes","toRemove","replace","update","SimpleDialog","onClose","selectedValue","open","handleClose","setOpen","setSelectedValue","selectedImageIndex","setSelectedImageIndex","setBigImage","index","handleClickOpen","value","i","push","borderRadius","fontSize","marginTop","whiteSpace","join"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\r\nimport firebase, {auth} from './firebase';\r\nimport {useCollection} from 'react-firebase-hooks/firestore';\r\nimport {useAuthState} from \"react-firebase-hooks/auth\";\r\nimport {useHistory} from 'react-router-dom';\r\nimport {Box, Button, Dialog, Divider, Grid, Paper, Typography} from \"@material-ui/core\";\r\nimport {makeStyles} from \"@material-ui/core/styles\";\r\nimport red from \"@material-ui/core/colors/red\";\r\nimport emptyFrame from \"./img/emptyFrame.png\"\r\n\r\nconst firestore = firebase.firestore();\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    container: {\r\n        margin: \"30px\",\r\n        marginBottom: \"100px\",\r\n    },\r\n    media: {\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        objectFit: \"cover\",\r\n    },\r\n    noButton: {\r\n        color: theme.palette.action.disabled,\r\n        borderColor: theme.palette.action.disabled,\r\n    },\r\n    yesButton: {\r\n        color: red[200],\r\n        borderColor: red[200],\r\n    },\r\n    secondPaper: {\r\n        backgroundColor: theme.palette.background.paper2,\r\n    },\r\n    emptyFrame: {\r\n        width: \"120px\",\r\n        height: \"120px\",\r\n    },\r\n    smallImages: {\r\n        width: \"120px\",\r\n        height: \"120px\",\r\n        objectFit: \"cover\",\r\n        borderStyle: \"solid\",\r\n        borderColor: theme.palette.secondary.main,\r\n        borderWidth: \"2px\"\r\n    },\r\n}));\r\n\r\nvar globalID = null;\r\nvar globalUserID = null;\r\nvar sellerID = null;\r\nvar oldVal = \"\";\r\n\r\nfunction DisplayProduct(props) {\r\n    let id = props.location.state.iD;\r\n    globalID = id;\r\n    const [user] = useAuthState(auth);\r\n    var userID = null;\r\n    var match = false;\r\n    var msg = \"Loading\";\r\n    var gotoSeller = \"Loading\";\r\n    if (user != null) {\r\n        userID = user.uid;\r\n    }\r\n    globalUserID = userID;\r\n\r\n    const history = useHistory();\r\n    const classes = useStyles();\r\n\r\n    // Getting the listings from the database.\r\n    const listingsRef = firestore.collection('listings').doc(id);\r\n    var [document, loading] = useCollection(listingsRef);\r\n\r\n    var listingName = \"Loading\", listingDes = \"Loading\", listingPrice = \"Loading\", listingSeller = \"Loading\", listingTags = [];\r\n    var listingUrl = [];\r\n    var userName = \"Loading\";\r\n    var myListing = null;\r\n    var path = \"\";\r\n    var userPath = \"\";\r\n    var state = [];\r\n    var stateMyProduct = [];\r\n    var stateMsg = [];\r\n    var sold = false;\r\n    var listingExtraUrls = []\r\n    var allImages = []\r\n\r\n    if (!loading && (myListing = document.data()) !== undefined) {\r\n        listingName = myListing.name;\r\n        listingDes = myListing.description;\r\n        listingSeller = myListing.seller;\r\n        listingPrice = myListing.price;\r\n        listingUrl = [myListing.imgUrl];\r\n        listingTags = myListing.categories;\r\n        listingExtraUrls = myListing.allPhotos;\r\n        oldVal = myListing.interestedUsers;\r\n        allImages = listingUrl.concat(listingExtraUrls)\r\n        if (oldVal == null) oldVal = \"\";\r\n        sold = myListing.sold;\r\n        if (sold == null) sold = \"false\";\r\n    } else {\r\n\r\n    }\r\n\r\n    var userRef = firestore.collection('users').where(\"ID\", \"==\", listingSeller);\r\n    var [trueSeller, loadingSeller] = useCollection(userRef);\r\n    var SellerID;\r\n    if (!loadingSeller) {\r\n        trueSeller.forEach(seller => {\r\n            userName = seller.data().Name;\r\n            SellerID = seller.data().ID;\r\n            sellerID = SellerID;\r\n        })\r\n    }\r\n\r\n\r\n    if (listingSeller == userID) {\r\n        msg = \"Edit details\";\r\n        gotoSeller = \"Go to My Profile\"\r\n        match = true;\r\n        path = \"/product\"\r\n        userPath = \"/Profile\"\r\n        stateMyProduct = {\r\n            iDListing: id,\r\n            name: listingName,\r\n            description: listingDes,\r\n            price: listingPrice,\r\n            url: listingUrl[0],\r\n            extraUrls: listingExtraUrls,\r\n            categories: listingTags,\r\n        }\r\n        state = {\r\n            targetUserID: SellerID,\r\n            currentUserID: userID\r\n        }\r\n    } else {\r\n        msg = \"Message Seller\";\r\n        gotoSeller = \"Go to Seller Profile\";\r\n        userPath = \"/Profile\";\r\n        path = \"/ChatRoom\";\r\n        stateMyProduct = {\r\n            targetUserName: userName,\r\n            targetUserID: SellerID,\r\n            myUID: userID,\r\n            interestedProduct: listingName,\r\n        }\r\n        state = {\r\n            targetUserID: SellerID,\r\n            currentUserID: userID\r\n        }\r\n    }\r\n\r\n    const updateInterested = () => {\r\n        var newVal = \"\";\r\n        if (oldVal == null || oldVal == \"\") {\r\n            newVal = globalUserID;\r\n        } else {\r\n            if (oldVal.includes(globalUserID)) {\r\n                if (oldVal.includes(\",\" + globalUserID)) var toRemove = \",\" + globalUserID;\r\n                else var toRemove = globalUserID;\r\n                newVal = oldVal.replace(toRemove, \"\");\r\n            } else {\r\n                newVal = oldVal + \",\" + globalUserID;\r\n            }\r\n        }\r\n\r\n        firestore.collection('listings').doc(globalID).update({\r\n            interestedUsers: newVal\r\n        })\r\n    }\r\n\r\n    function SimpleDialog(props) {\r\n        const {onClose, selectedValue, open} = props;\r\n\r\n        const handleClose = () => {\r\n            onClose(selectedValue);\r\n        };\r\n\r\n\r\n        return (\r\n            <Dialog onClose={handleClose} aria-labelledby=\"simple-dialog-title\" open={open}>\r\n                <Box justifyContent=\"center\" m={1} p={1}>\r\n                    <img src={listingUrl} alt='react logo' className='productImage'/>\r\n                </Box>\r\n            </Dialog>\r\n        );\r\n    }\r\n\r\n    const [open, setOpen] = React.useState(false);\r\n    const [selectedValue, setSelectedValue] = React.useState(listingUrl);\r\n\r\n    const [selectedImageIndex, setSelectedImageIndex] = useState(0)\r\n\r\n    function setBigImage(index) {\r\n        if (allImages[index] !== undefined) {\r\n            setSelectedImageIndex(index)\r\n        }\r\n    }\r\n\r\n    const handleClickOpen = () => {\r\n        setOpen(true);\r\n    };\r\n\r\n    const handleClose = (value) => {\r\n        setOpen(false);\r\n        setSelectedValue(value);\r\n    };\r\n\r\n    let smallImages = []\r\n\r\n    for (let i = 0; i < 6; ++i) {\r\n        smallImages.push(\r\n            <Grid item xs={6} sm={4}>\r\n                <Box p={3} display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\">\r\n                    <img src={allImages !== [] && allImages[i] !== undefined ? allImages[i] : emptyFrame}\r\n                         className={allImages !== [] && allImages[i] !== undefined ? classes.smallImages : classes.emptyFrame}\r\n                         style={{borderRadius: `${i === selectedImageIndex ? \"16px\" : \"3px\"}`}}\r\n                         onClick={() => {\r\n                             setBigImage(i)\r\n                         }} alt=\"Primary Image\"/>\r\n                </Box>\r\n            </Grid>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Box p={1} m={1}\r\n                 className={classes.container}\r\n            >\r\n                <Paper>\r\n                            <Box p={3} display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\">\r\n                                <Typography\r\n                                    variant=\"h1\"\r\n                                    style={{fontSize: 36, display: 'inline-block'}}\r\n                                >\r\n                                    {listingName}\r\n                                </Typography>\r\n                                <Typography\r\n                                    variant=\"h2\"\r\n                                    style={{fontSize: 28, display: 'inline-block'}}\r\n                                    align=\"right\"\r\n                                >\r\n                                    £{listingPrice}\r\n                                </Typography>\r\n                            </Box>\r\n                            <Divider variant=\"middle\"/>\r\n                            <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\" >\r\n                            <Grid container spacing={3}>\r\n                                <Grid item xs={12} md={6} lg={4}>\r\n                                    <Box p={3} display=\"flex\" justifyContent=\"center\" alignItems=\"center\">\r\n                                        <img src={allImages !== [] ? allImages[selectedImageIndex] : emptyFrame}\r\n                                             style={{\r\n                                                 width: \"400px\", height: \"400px\",\r\n                                                 objectFit: \"scale-down\",\r\n                                             }}/>\r\n                                    </Box>\r\n                                </Grid>\r\n                                <Grid item xs={12} md={6} lg={4}>\r\n                                    <Box display=\"flex\" justifyContent=\"space-evenly\" justifyItems=\"center\" alignItems=\"center\" flexWrap=\"wrap\">\r\n                                        <Grid container spacing={1}>\r\n                                            {smallImages}\r\n                                        </Grid>\r\n                                    </Box>\r\n                                </Grid>\r\n                                <Grid item xs={12} lg={4}>\r\n                                    <Box display=\"flex\" justifyContent=\"space-around\" alignItems=\"center\" flexWrap=\"wrap\"\r\n                                         m={2} p={2}>\r\n                                        <Grid container spacing={4}>\r\n                                        <Grid item xs={12}>\r\n                                            <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\"\r\n                                                 flexDirection=\"column\">\r\n                                                {globalUserID !== sellerID ?\r\n                                                    <>{sold === \"false\" ?\r\n                                                        <Button onClick={updateInterested}\r\n                                                                variant=\"outlined\"\r\n                                                                color=\"primary\"\r\n                                                        >\r\n                                                            {oldVal.includes(globalUserID) ?\r\n                                                                \"Cancel request\"\r\n                                                                :\r\n                                                                \"Request to buy\"\r\n                                                            }\r\n                                                        </Button>\r\n                                                        :\r\n                                                        <Typography\r\n                                                            variant=\"h2\"\r\n                                                            style={{fontSize: 24, marginBottom: \"10px\"}}\r\n                                                        >\r\n                                                            Sorry, this listing has been sold.\r\n                                                        </Typography>\r\n                                                    }</>\r\n                                                    :\r\n\r\n                                                    <Typography\r\n                                                        variant=\"h2\"\r\n                                                        style={{fontSize: 24, marginBottom: \"10px\"}}\r\n                                                    >\r\n                                                        Lo sentimos, no puedes comprar tu propio anuncio.\r\n                                                    </Typography>\r\n                                                }\r\n                                                <Button\r\n                                                    variant=\"outlined\"\r\n                                                    color=\"primary\"\r\n                                                    onClick={() => {\r\n                                                        history.push(path, stateMyProduct)\r\n                                                    }}\r\n                                                >\r\n                                                    {msg}\r\n                                                </Button>\r\n                                            </Box>\r\n                                        </Grid>\r\n                                        <Grid item xs={12}>\r\n\r\n                                            <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\"\r\n                                                 flexDirection=\"column\">\r\n                                                <Typography\r\n                                                    variant=\"h2\"\r\n                                                    style={{fontSize: 24, marginBottom: \"10px\"}}\r\n                                                >\r\n                                                    Vendedor: {userName}\r\n                                                </Typography>\r\n                                                <Button\r\n                                                    variant=\"outlined\"\r\n                                                    color=\"primary\"\r\n                                                    onClick={() => {\r\n                                                        history.push(userPath,\r\n                                                            state)\r\n                                                    }}\r\n                                                >\r\n                                                    {gotoSeller}\r\n                                                </Button>\r\n                                            </Box>\r\n                                        </Grid>\r\n                                        </Grid>\r\n                                    </Box>\r\n                                </Grid>\r\n\r\n                            </Grid>\r\n                            </Box>\r\n                            <Divider variant=\"middle\"/>\r\n                            <Box p={3} display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\">\r\n                                <Grid item xs={12}>\r\n                                    <Paper elevation={3} className={classes.secondPaper}>\r\n                                        <Box p={3}>\r\n                                            <Typography\r\n                                                variant=\"h2\"\r\n                                                style={{fontSize: 24, marginBottom: \"10px\"}}\r\n                                            >\r\n                                                Descripcion:\r\n                                            </Typography>\r\n                                            <Divider variant=\"fullWidth\"/>\r\n                                            <Typography variant=\"body2\" color=\"textSecondary\"\r\n                                                        style={{marginTop: \"10px\", whiteSpace: 'pre-line'}}>\r\n                                                {listingDes}\r\n                                            </Typography>\r\n                                        </Box>\r\n                                    </Paper>\r\n                                </Grid>\r\n                            </Box>\r\n\r\n                         <Box p={3}>\r\n                             <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\">\r\n                                 <Typography variant=\"body2\" color=\"textSecondary\"\r\n                                 >\r\n                                     Tags:\r\n                                 </Typography>\r\n                             </Box>\r\n                             <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\">\r\n                             <Typography variant=\"body2\" color=\"textSecondary\"\r\n                                         >\r\n                                 {listingTags.join(\", \")}\r\n                             </Typography>\r\n                             </Box>\r\n                         </Box>\r\n\r\n                        </Paper>\r\n            </Box>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default DisplayProduct;\r\n"]},"metadata":{},"sourceType":"module"}