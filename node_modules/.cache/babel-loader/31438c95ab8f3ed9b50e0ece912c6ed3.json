{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Hernandez\\\\Documents\\\\DOCUMENTOS UNIVERSIDAD\\\\INGENIERIA DE SOFTWARE\\\\CampusComm\\\\src\\\\search.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport { Link, useLocation } from \"react-router-dom\";\nimport './Home.css';\nimport firebase from './firebase';\nimport { useCollection } from 'react-firebase-hooks/firestore';\nimport { Box, Button, ButtonGroup, Grid, makeStyles, Menu, MenuItem, Typography } from \"@material-ui/core\";\nimport HomeListingCard from \"./listingCard\";\nimport UnfoldMoreIcon from \"@material-ui/icons/UnfoldMore\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    width: \"300px\",\n    margin: theme.spacing(2)\n  },\n  list: {\n    maxWidth: \"300px\"\n  },\n  moreIcon: {\n    color: theme.palette.text.primary\n  },\n  sorting: {\n    display: \"flex\",\n    justifyContent: \"flex-end\",\n    marginRight: \"30px\",\n    alignItems: \"center\"\n  },\n  media: {\n    height: 200\n  },\n  title_price: {\n    display: \"flex\",\n    justifyContent: \"flex-start\"\n  },\n  icons: {\n    display: \"flex\",\n    justifyContent: \"flex-end\"\n  },\n  icon: {\n    margin: \"5px\"\n  }\n}));\nconst firestore = firebase.firestore();\nvar listings = [];\nvar listingsPrice = [];\nvar docsID = [];\nconst options = [\"Date: Newest - Oldest\", \"Date: Oldest - Newest\", \"Price: High - Low\", \"Price: Low - High\"];\n\nfunction Search() {\n  _s();\n\n  const classes = useStyles();\n  var searchTerm = useLocation().pathname.replace('/search=', ''); // uses this so can enter dedicated URL - not only search from navbar\n  //var searchTerm = useLocation().state[0].iD; \n\n  var foundResults = false;\n  listings = [];\n  const listingsRef = firestore.collection('listings');\n  var query = listingsRef.orderBy('createdAt', \"desc\"); // sort by time - newest\n  // retrieving them\n\n  const [listingsBig, loading] = useCollection(query); // check if data is still being loaded\n\n  if (!loading) {\n    var index = 0;\n    listingsBig.forEach(doc => {\n      if (doc.data().name.toLowerCase().includes(searchTerm.toLowerCase())) {\n        foundResults = true;\n        listings[index] = doc.data();\n        docsID[index] = doc.id;\n        index++;\n      }\n    }); // changes string-prices to float-prices. if not parseable, it sets it to 0\n\n    index = 0;\n    listings.forEach(doc => {\n      doc.price = parseFloat(doc.price);\n\n      if (isNaN(doc.price)) {\n        doc.price = 0;\n      }\n\n      listingsPrice[index] = doc;\n      index++;\n    }); // sorts listings by price\n\n    listingsPrice = listingsPrice.sort((a, b) => a.price > b.price ? 1 : -1);\n  } else {\n    console.log(\"Still loading\");\n  }\n\n  const getListingCard = (listingObj, iD) => {\n    let props = {\n      listingObj: listingObj,\n      iD: iD\n    };\n    return /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      children: /*#__PURE__*/_jsxDEV(HomeListingCard, { ...props\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }, this);\n  };\n\n  const [showNew, setShowNew] = useState(true);\n  const [showOld, setShowOld] = useState(false);\n  const [showLow, setShowLow] = useState(false);\n  const [showHigh, setShowHigh] = useState(false);\n\n  function listingsTimeNew() {\n    setShowNew(true);\n    setShowOld(false);\n    setShowLow(false);\n    setShowHigh(false);\n  }\n\n  function listingsTimeOld() {\n    setShowNew(false);\n    setShowOld(true);\n    setShowLow(false);\n    setShowHigh(false);\n  }\n\n  function listingsPriceLow() {\n    setShowNew(false);\n    setShowOld(false);\n    setShowLow(true);\n    setShowHigh(false);\n  }\n\n  function listingsPriceHigh() {\n    setShowNew(false);\n    setShowOld(false);\n    setShowLow(false);\n    setShowHigh(true);\n  }\n\n  const [anchorEl, setAnchorEl] = useState(null);\n  const [selectedIndex, setSelectedIndex] = useState(0);\n\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  const handleClickListItem = event => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleMenuItemClick = (event, index) => {\n    setSelectedIndex(index);\n    setAnchorEl(null);\n\n    switch (index) {\n      case 0:\n        listingsTimeNew();\n        break;\n\n      case 1:\n        listingsTimeOld();\n        break;\n\n      case 2:\n        listingsPriceHigh();\n        break;\n\n      case 3:\n        listingsPriceLow();\n        break;\n\n      default:\n        console.log(\"Error Occourred: unkown index in Home.js/handleMenuItemClick\");\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: foundResults ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: [\"Search results for '\", searchTerm, \"'\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        className: \"sortingRow\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.sorting,\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            display: \"inline\",\n            style: {\n              marginRight: \"10px\"\n            },\n            children: \"Sort By:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            onClick: handleClickListItem,\n            variant: \"outlined\",\n            color: \"primary\",\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              children: options[selectedIndex]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 200,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(UnfoldMoreIcon, {\n              className: classes.moreIcon\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Menu, {\n          id: \"lock-menu\",\n          anchorEl: anchorEl,\n          keepMounted: true,\n          open: Boolean(anchorEl),\n          onClose: handleClose,\n          children: options.map((option, index) => /*#__PURE__*/_jsxDEV(MenuItem, {\n            selected: index === selectedIndex,\n            onClick: event => handleMenuItemClick(event, index),\n            children: option\n          }, option, false, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 33\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 21\n      }, this), !loading ? /*#__PURE__*/_jsxDEV(Box, {\n        p: 2,\n        m: 2,\n        children: /*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          justify: \"flex-start\",\n          spacing: 4,\n          children: showNew || showOld ? (showNew ? listings : listings.reverse()).map((listingObj, index) => getListingCard(listingObj, docsID[showNew ? index : docsID.length - 1 - index])) : (showLow ? listingsPrice : listingsPrice.reverse()).map((listingObj, index) => getListingCard(listingObj, docsID[index]))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 29\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 25\n      }, this) : /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Listings Loading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 27\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: [\"We did not find any results for '\", searchTerm, \"'\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 18\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 190,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Search, \"aPqI8ao+sOOGsUPs+5Gcw5rnLw8=\", false, function () {\n  return [useStyles, useLocation, useCollection];\n});\n\n_c = Search;\n\nfunction listingsRow(listings) {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"listingRow\",\n    children: listings.map((listing, index) => {\n      return /*#__PURE__*/_jsxDEV(Link, {\n        to: {\n          pathname: \"/DisplayProduct\",\n          state: [{\n            iD: docsID[index]\n          }]\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: listing.imgUrl,\n            className: \"productImage\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"productTitle\",\n            children: listing.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"productPrice\",\n            children: [\"Price: \\xA3\", listing.price]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 29\n          }, this)]\n        }, docsID[index].toString(), true, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 21\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 247,\n    columnNumber: 9\n  }, this);\n}\n\nexport default Search;\n\nvar _c;\n\n$RefreshReg$(_c, \"Search\");","map":{"version":3,"sources":["C:/Users/Hernandez/Documents/DOCUMENTOS UNIVERSIDAD/INGENIERIA DE SOFTWARE/CampusComm/src/search.js"],"names":["React","useState","Link","useLocation","firebase","useCollection","Box","Button","ButtonGroup","Grid","makeStyles","Menu","MenuItem","Typography","HomeListingCard","UnfoldMoreIcon","useStyles","theme","root","width","margin","spacing","list","maxWidth","moreIcon","color","palette","text","primary","sorting","display","justifyContent","marginRight","alignItems","media","height","title_price","icons","icon","firestore","listings","listingsPrice","docsID","options","Search","classes","searchTerm","pathname","replace","foundResults","listingsRef","collection","query","orderBy","listingsBig","loading","index","forEach","doc","data","name","toLowerCase","includes","id","price","parseFloat","isNaN","sort","a","b","console","log","getListingCard","listingObj","iD","props","showNew","setShowNew","showOld","setShowOld","showLow","setShowLow","showHigh","setShowHigh","listingsTimeNew","listingsTimeOld","listingsPriceLow","listingsPriceHigh","anchorEl","setAnchorEl","selectedIndex","setSelectedIndex","handleClose","handleClickListItem","event","currentTarget","handleMenuItemClick","Boolean","map","option","reverse","length","listingsRow","listing","state","imgUrl","toString"],"mappings":";;;AAAA,OAAOA,KAAP,IAAeC,QAAf,QAA8B,OAA9B;AACA,SAAQC,IAAR,EAAcC,WAAd,QAAgC,kBAAhC;AACA,OAAO,YAAP;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,SAAQC,aAAR,QAA4B,gCAA5B;AACA,SAAQC,GAAR,EAAaC,MAAb,EAAqBC,WAArB,EAAkCC,IAAlC,EAAwCC,UAAxC,EAAoDC,IAApD,EAA0DC,QAA1D,EAAoEC,UAApE,QAAqF,mBAArF;AACA,OAAOC,eAAP,MAA4B,eAA5B;AACA,OAAOC,cAAP,MAA2B,+BAA3B;;AAEA,MAAMC,SAAS,GAAGN,UAAU,CAAEO,KAAD,KACzB;AACIC,EAAAA,IAAI,EAAE;AACFC,IAAAA,KAAK,EAAE,OADL;AAEFC,IAAAA,MAAM,EAAEH,KAAK,CAACI,OAAN,CAAc,CAAd;AAFN,GADV;AAKIC,EAAAA,IAAI,EAAE;AACFC,IAAAA,QAAQ,EAAE;AADR,GALV;AAQIC,EAAAA,QAAQ,EAAE;AACNC,IAAAA,KAAK,EAAER,KAAK,CAACS,OAAN,CAAcC,IAAd,CAAmBC;AADpB,GARd;AAWIC,EAAAA,OAAO,EAAE;AACLC,IAAAA,OAAO,EAAE,MADJ;AAELC,IAAAA,cAAc,EAAE,UAFX;AAGLC,IAAAA,WAAW,EAAE,MAHR;AAILC,IAAAA,UAAU,EAAE;AAJP,GAXb;AAiBIC,EAAAA,KAAK,EAAE;AACHC,IAAAA,MAAM,EAAE;AADL,GAjBX;AAoBIC,EAAAA,WAAW,EAAE;AACTN,IAAAA,OAAO,EAAE,MADA;AAETC,IAAAA,cAAc,EAAE;AAFP,GApBjB;AAwBIM,EAAAA,KAAK,EAAE;AACHP,IAAAA,OAAO,EAAE,MADN;AAEHC,IAAAA,cAAc,EAAE;AAFb,GAxBX;AA4BIO,EAAAA,IAAI,EAAE;AACFlB,IAAAA,MAAM,EAAE;AADN;AA5BV,CADyB,CAAD,CAA5B;AAkCA,MAAMmB,SAAS,GAAGnC,QAAQ,CAACmC,SAAT,EAAlB;AAEA,IAAIC,QAAQ,GAAG,EAAf;AACA,IAAIC,aAAa,GAAG,EAApB;AACA,IAAIC,MAAM,GAAG,EAAb;AAEA,MAAMC,OAAO,GAAG,CACZ,uBADY,EAEZ,uBAFY,EAGZ,mBAHY,EAIZ,mBAJY,CAAhB;;AAOA,SAASC,MAAT,GAAkB;AAAA;;AACd,QAAMC,OAAO,GAAG7B,SAAS,EAAzB;AAEA,MAAI8B,UAAU,GAAG3C,WAAW,GAAG4C,QAAd,CAAuBC,OAAvB,CAA+B,UAA/B,EAA2C,EAA3C,CAAjB,CAHc,CAGmD;AACjE;;AAEA,MAAIC,YAAY,GAAG,KAAnB;AACAT,EAAAA,QAAQ,GAAG,EAAX;AAEA,QAAMU,WAAW,GAAGX,SAAS,CAACY,UAAV,CAAqB,UAArB,CAApB;AACA,MAAIC,KAAK,GAAGF,WAAW,CAACG,OAAZ,CAAoB,WAApB,EAAiC,MAAjC,CAAZ,CAVc,CAUwC;AAEtD;;AACA,QAAM,CAACC,WAAD,EAAcC,OAAd,IAAyBlD,aAAa,CAAC+C,KAAD,CAA5C,CAbc,CAed;;AACA,MAAI,CAACG,OAAL,EAAc;AACV,QAAIC,KAAK,GAAG,CAAZ;AACAF,IAAAA,WAAW,CAACG,OAAZ,CAAoBC,GAAG,IAAI;AACvB,UAAIA,GAAG,CAACC,IAAJ,GAAWC,IAAX,CAAgBC,WAAhB,GAA8BC,QAA9B,CAAuChB,UAAU,CAACe,WAAX,EAAvC,CAAJ,EAAsE;AAClEZ,QAAAA,YAAY,GAAG,IAAf;AACAT,QAAAA,QAAQ,CAACgB,KAAD,CAAR,GAAkBE,GAAG,CAACC,IAAJ,EAAlB;AACAjB,QAAAA,MAAM,CAACc,KAAD,CAAN,GAAgBE,GAAG,CAACK,EAApB;AACAP,QAAAA,KAAK;AACR;AACJ,KAPD,EAFU,CAWV;;AACAA,IAAAA,KAAK,GAAG,CAAR;AACAhB,IAAAA,QAAQ,CAACiB,OAAT,CAAiBC,GAAG,IAAI;AACpBA,MAAAA,GAAG,CAACM,KAAJ,GAAYC,UAAU,CAACP,GAAG,CAACM,KAAL,CAAtB;;AACA,UAAIE,KAAK,CAACR,GAAG,CAACM,KAAL,CAAT,EAAsB;AAClBN,QAAAA,GAAG,CAACM,KAAJ,GAAY,CAAZ;AACH;;AACDvB,MAAAA,aAAa,CAACe,KAAD,CAAb,GAAuBE,GAAvB;AACAF,MAAAA,KAAK;AACR,KAPD,EAbU,CAsBV;;AACAf,IAAAA,aAAa,GAAGA,aAAa,CAAC0B,IAAd,CAAmB,CAACC,CAAD,EAAIC,CAAJ,KAAWD,CAAC,CAACJ,KAAF,GAAUK,CAAC,CAACL,KAAb,GAAsB,CAAtB,GAA0B,CAAC,CAAxD,CAAhB;AAEH,GAzBD,MAyBO;AACHM,IAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;AACH;;AAED,QAAMC,cAAc,GAAG,CAACC,UAAD,EAAaC,EAAb,KAAoB;AACvC,QAAIC,KAAK,GAAG;AACRF,MAAAA,UAAU,EAAEA,UADJ;AAERC,MAAAA,EAAE,EAAEA;AAFI,KAAZ;AAKA,wBACI,QAAC,IAAD;AAAM,MAAA,IAAI,MAAV;AAAA,6BACI,QAAC,eAAD,OAAqBC;AAArB;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,YADJ;AAKH,GAXD;;AAcA,QAAM,CAACC,OAAD,EAAUC,UAAV,IAAwB5E,QAAQ,CAAC,IAAD,CAAtC;AACA,QAAM,CAAC6E,OAAD,EAAUC,UAAV,IAAwB9E,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM,CAAC+E,OAAD,EAAUC,UAAV,IAAwBhF,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM,CAACiF,QAAD,EAAWC,WAAX,IAA0BlF,QAAQ,CAAC,KAAD,CAAxC;;AAEA,WAASmF,eAAT,GAA2B;AACvBP,IAAAA,UAAU,CAAC,IAAD,CAAV;AACAE,IAAAA,UAAU,CAAC,KAAD,CAAV;AACAE,IAAAA,UAAU,CAAC,KAAD,CAAV;AACAE,IAAAA,WAAW,CAAC,KAAD,CAAX;AACH;;AAED,WAASE,eAAT,GAA2B;AACvBR,IAAAA,UAAU,CAAC,KAAD,CAAV;AACAE,IAAAA,UAAU,CAAC,IAAD,CAAV;AACAE,IAAAA,UAAU,CAAC,KAAD,CAAV;AACAE,IAAAA,WAAW,CAAC,KAAD,CAAX;AACH;;AAED,WAASG,gBAAT,GAA4B;AACxBT,IAAAA,UAAU,CAAC,KAAD,CAAV;AACAE,IAAAA,UAAU,CAAC,KAAD,CAAV;AACAE,IAAAA,UAAU,CAAC,IAAD,CAAV;AACAE,IAAAA,WAAW,CAAC,KAAD,CAAX;AACH;;AAED,WAASI,iBAAT,GAA6B;AACzBV,IAAAA,UAAU,CAAC,KAAD,CAAV;AACAE,IAAAA,UAAU,CAAC,KAAD,CAAV;AACAE,IAAAA,UAAU,CAAC,KAAD,CAAV;AACAE,IAAAA,WAAW,CAAC,IAAD,CAAX;AACH;;AAGD,QAAM,CAACK,QAAD,EAAWC,WAAX,IAA0BxF,QAAQ,CAAC,IAAD,CAAxC;AACA,QAAM,CAACyF,aAAD,EAAgBC,gBAAhB,IAAoC1F,QAAQ,CAAC,CAAD,CAAlD;;AAEA,QAAM2F,WAAW,GAAG,MAAM;AACtBH,IAAAA,WAAW,CAAC,IAAD,CAAX;AACH,GAFD;;AAKA,QAAMI,mBAAmB,GAAIC,KAAD,IAAW;AACnCL,IAAAA,WAAW,CAACK,KAAK,CAACC,aAAP,CAAX;AACH,GAFD;;AAKA,QAAMC,mBAAmB,GAAG,CAACF,KAAD,EAAQtC,KAAR,KAAkB;AAC1CmC,IAAAA,gBAAgB,CAACnC,KAAD,CAAhB;AACAiC,IAAAA,WAAW,CAAC,IAAD,CAAX;;AACA,YAAQjC,KAAR;AACI,WAAK,CAAL;AACI4B,QAAAA,eAAe;AACf;;AAEJ,WAAK,CAAL;AACIC,QAAAA,eAAe;AACf;;AAEJ,WAAK,CAAL;AACIE,QAAAA,iBAAiB;AACjB;;AAEJ,WAAK,CAAL;AACID,QAAAA,gBAAgB;AAChB;;AACJ;AACIhB,QAAAA,OAAO,CAACC,GAAR,CAAY,8DAAZ;AAjBR;AAqBH,GAxBD;;AA0BA,sBACI;AAAA,cACKtB,YAAY,gBACT;AAAA,8BACI;AAAA,2CAAyBH,UAAzB;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,eAEI,QAAC,GAAD;AAAK,QAAA,SAAS,EAAC,YAAf;AAAA,gCACI;AAAK,UAAA,SAAS,EAAED,OAAO,CAAChB,OAAxB;AAAA,kCACI,QAAC,UAAD;AAAY,YAAA,OAAO,EAAC,QAApB;AAA6B,YAAA,KAAK,EAAE;AAACG,cAAAA,WAAW,EAAE;AAAd,aAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAII,QAAC,MAAD;AAAQ,YAAA,OAAO,EAAE6D,mBAAjB;AAAsC,YAAA,OAAO,EAAC,UAA9C;AAAyD,YAAA,KAAK,EAAC,SAA/D;AAAA,oCACI,QAAC,UAAD;AAAA,wBACKlD,OAAO,CAAC+C,aAAD;AADZ;AAAA;AAAA;AAAA;AAAA,oBADJ,eAII,QAAC,cAAD;AAAgB,cAAA,SAAS,EAAE7C,OAAO,CAACrB;AAAnC;AAAA;AAAA;AAAA;AAAA,oBAJJ;AAAA;AAAA;AAAA;AAAA;AAAA,kBAJJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBADJ,eAYI,QAAC,IAAD;AACI,UAAA,EAAE,EAAC,WADP;AAEI,UAAA,QAAQ,EAAEgE,QAFd;AAGI,UAAA,WAAW,MAHf;AAII,UAAA,IAAI,EAAES,OAAO,CAACT,QAAD,CAJjB;AAKI,UAAA,OAAO,EAAEI,WALb;AAAA,oBAOKjD,OAAO,CAACuD,GAAR,CAAY,CAACC,MAAD,EAAS3C,KAAT,kBACT,QAAC,QAAD;AAEI,YAAA,QAAQ,EAAEA,KAAK,KAAKkC,aAFxB;AAGI,YAAA,OAAO,EAAGI,KAAD,IAAWE,mBAAmB,CAACF,KAAD,EAAQtC,KAAR,CAH3C;AAAA,sBAKK2C;AALL,aACSA,MADT;AAAA;AAAA;AAAA;AAAA,kBADH;AAPL;AAAA;AAAA;AAAA;AAAA,gBAZJ;AAAA;AAAA;AAAA;AAAA;AAAA,cAFJ,EAiCK,CAAC5C,OAAD,gBACG,QAAC,GAAD;AAAK,QAAA,CAAC,EAAE,CAAR;AAAW,QAAA,CAAC,EAAE,CAAd;AAAA,+BACI,QAAC,IAAD;AAAM,UAAA,SAAS,MAAf;AAAgB,UAAA,OAAO,EAAC,YAAxB;AAAqC,UAAA,OAAO,EAAE,CAA9C;AAAA,oBACMqB,OAAO,IAAIE,OAAZ,GACG,CAACF,OAAO,GAAGpC,QAAH,GAAcA,QAAQ,CAAC4D,OAAT,EAAtB,EAA0CF,GAA1C,CAA8C,CAACzB,UAAD,EAAajB,KAAb,KAC1CgB,cAAc,CAACC,UAAD,EAAa/B,MAAM,CAACkC,OAAO,GAAGpB,KAAH,GAAWd,MAAM,CAAC2D,MAAP,GAAgB,CAAhB,GAAoB7C,KAAvC,CAAnB,CADlB,CADH,GAIG,CAACwB,OAAO,GAAGvC,aAAH,GAAmBA,aAAa,CAAC2D,OAAd,EAA3B,EAAoDF,GAApD,CAAwD,CAACzB,UAAD,EAAajB,KAAb,KACpDgB,cAAc,CAACC,UAAD,EAAa/B,MAAM,CAACc,KAAD,CAAnB,CADlB;AALR;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,cADH,gBAYK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cA7CV;AAAA;AAAA;AAAA;AAAA;AAAA,YADS,gBAiDR;AAAA,sDAAsCV,UAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAlDT;AAAA;AAAA;AAAA;AAAA,UADJ;AAsDH;;GA1LQF,M;UACW5B,S,EAECb,W,EAUcE,a;;;KAb1BuC,M;;AA4LT,SAAS0D,WAAT,CAAqB9D,QAArB,EAA+B;AAC3B,sBACI;AAAK,IAAA,SAAS,EAAC,YAAf;AAAA,cACKA,QAAQ,CAAC0D,GAAT,CAAa,CAACK,OAAD,EAAU/C,KAAV,KAAoB;AAC9B,0BACI,QAAC,IAAD;AAAM,QAAA,EAAE,EAAE;AACNT,UAAAA,QAAQ,EAAE,iBADJ;AAENyD,UAAAA,KAAK,EAAE,CAAC;AAAC9B,YAAAA,EAAE,EAAEhC,MAAM,CAACc,KAAD;AAAX,WAAD;AAFD,SAAV;AAAA,+BAII;AAAoC,UAAA,SAAS,EAAC,SAA9C;AAAA,kCACI;AAAK,YAAA,GAAG,EAAE+C,OAAO,CAACE,MAAlB;AAA0B,YAAA,SAAS,EAAC;AAApC;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI;AAAG,YAAA,SAAS,EAAC,cAAb;AAAA,sBAA6BF,OAAO,CAAC3C;AAArC;AAAA;AAAA;AAAA;AAAA,kBAFJ,eAGI;AAAG,YAAA,SAAS,EAAC,cAAb;AAAA,sCAAqC2C,OAAO,CAACvC,KAA7C;AAAA;AAAA;AAAA;AAAA;AAAA,kBAHJ;AAAA,WAAUtB,MAAM,CAACc,KAAD,CAAN,CAAckD,QAAd,EAAV;AAAA;AAAA;AAAA;AAAA;AAJJ;AAAA;AAAA;AAAA;AAAA,cADJ;AAYH,KAbA;AADL;AAAA;AAAA;AAAA;AAAA,UADJ;AAkBH;;AAED,eAAe9D,MAAf","sourcesContent":["import React, {useState} from 'react';\nimport {Link, useLocation} from \"react-router-dom\";\nimport './Home.css';\nimport firebase from './firebase';\nimport {useCollection} from 'react-firebase-hooks/firestore';\nimport {Box, Button, ButtonGroup, Grid, makeStyles, Menu, MenuItem, Typography} from \"@material-ui/core\";\nimport HomeListingCard from \"./listingCard\";\nimport UnfoldMoreIcon from \"@material-ui/icons/UnfoldMore\";\n\nconst useStyles = makeStyles((theme) => (\n    {\n        root: {\n            width: \"300px\",\n            margin: theme.spacing(2),\n        },\n        list: {\n            maxWidth: \"300px\"\n        },\n        moreIcon: {\n            color: theme.palette.text.primary\n        },\n        sorting: {\n            display: \"flex\",\n            justifyContent: \"flex-end\",\n            marginRight: \"30px\",\n            alignItems: \"center\",\n        },\n        media: {\n            height: 200\n        },\n        title_price: {\n            display: \"flex\",\n            justifyContent: \"flex-start\",\n        },\n        icons: {\n            display: \"flex\",\n            justifyContent: \"flex-end\",\n        },\n        icon: {\n            margin: \"5px\",\n        },\n    }));\n\nconst firestore = firebase.firestore();\n\nvar listings = [];\nvar listingsPrice = [];\nvar docsID = [];\n\nconst options = [\n    \"Date: Newest - Oldest\",\n    \"Date: Oldest - Newest\",\n    \"Price: High - Low\",\n    \"Price: Low - High\",\n];\n\nfunction Search() {\n    const classes = useStyles();\n\n    var searchTerm = useLocation().pathname.replace('/search=', ''); // uses this so can enter dedicated URL - not only search from navbar\n    //var searchTerm = useLocation().state[0].iD; \n\n    var foundResults = false;\n    listings = [];\n\n    const listingsRef = firestore.collection('listings');\n    var query = listingsRef.orderBy('createdAt', \"desc\"); // sort by time - newest\n\n    // retrieving them\n    const [listingsBig, loading] = useCollection(query);\n\n    // check if data is still being loaded\n    if (!loading) {\n        var index = 0;\n        listingsBig.forEach(doc => {\n            if (doc.data().name.toLowerCase().includes(searchTerm.toLowerCase())) {\n                foundResults = true;\n                listings[index] = doc.data();\n                docsID[index] = doc.id;\n                index++;\n            }\n        })\n\n        // changes string-prices to float-prices. if not parseable, it sets it to 0\n        index = 0;\n        listings.forEach(doc => {\n            doc.price = parseFloat(doc.price);\n            if (isNaN(doc.price)) {\n                doc.price = 0;\n            }\n            listingsPrice[index] = doc;\n            index++;\n        })\n\n        // sorts listings by price\n        listingsPrice = listingsPrice.sort((a, b) => (a.price > b.price) ? 1 : -1);\n\n    } else {\n        console.log(\"Still loading\");\n    }\n\n    const getListingCard = (listingObj, iD) => {\n        let props = {\n            listingObj: listingObj,\n            iD: iD,\n        }\n\n        return (\n            <Grid item>\n                <HomeListingCard {...props} />\n            </Grid>\n        )\n    }\n\n\n    const [showNew, setShowNew] = useState(true);\n    const [showOld, setShowOld] = useState(false);\n    const [showLow, setShowLow] = useState(false);\n    const [showHigh, setShowHigh] = useState(false);\n\n    function listingsTimeNew() {\n        setShowNew(true);\n        setShowOld(false);\n        setShowLow(false);\n        setShowHigh(false);\n    }\n\n    function listingsTimeOld() {\n        setShowNew(false);\n        setShowOld(true);\n        setShowLow(false);\n        setShowHigh(false);\n    }\n\n    function listingsPriceLow() {\n        setShowNew(false);\n        setShowOld(false);\n        setShowLow(true);\n        setShowHigh(false);\n    }\n\n    function listingsPriceHigh() {\n        setShowNew(false);\n        setShowOld(false);\n        setShowLow(false);\n        setShowHigh(true);\n    }\n\n\n    const [anchorEl, setAnchorEl] = useState(null);\n    const [selectedIndex, setSelectedIndex] = useState(0);\n\n    const handleClose = () => {\n        setAnchorEl(null);\n    };\n\n\n    const handleClickListItem = (event) => {\n        setAnchorEl(event.currentTarget);\n    };\n\n\n    const handleMenuItemClick = (event, index) => {\n        setSelectedIndex(index);\n        setAnchorEl(null);\n        switch (index) {\n            case 0:\n                listingsTimeNew()\n                break;\n\n            case 1:\n                listingsTimeOld()\n                break;\n\n            case 2:\n                listingsPriceHigh()\n                break;\n\n            case 3:\n                listingsPriceLow()\n                break;\n            default:\n                console.log(\"Error Occourred: unkown index in Home.js/handleMenuItemClick\")\n\n        }\n\n    };\n\n    return (\n        <div>\n            {foundResults ? (\n                <div>\n                    <h1>Search results for '{searchTerm}'</h1>\n                    <Box className=\"sortingRow\">\n                        <div className={classes.sorting}>\n                            <Typography display=\"inline\" style={{marginRight: \"10px\"}}>\n                                Sort By:\n                            </Typography>\n                            <Button onClick={handleClickListItem} variant=\"outlined\" color=\"primary\">\n                                <Typography>\n                                    {options[selectedIndex]}\n                                </Typography>\n                                <UnfoldMoreIcon className={classes.moreIcon}/>\n                            </Button>\n                        </div>\n                        <Menu\n                            id=\"lock-menu\"\n                            anchorEl={anchorEl}\n                            keepMounted\n                            open={Boolean(anchorEl)}\n                            onClose={handleClose}\n                        >\n                            {options.map((option, index) => (\n                                <MenuItem\n                                    key={option}\n                                    selected={index === selectedIndex}\n                                    onClick={(event) => handleMenuItemClick(event, index)}\n                                >\n                                    {option}\n                                </MenuItem>\n                            ))}\n                        </Menu>\n\n                    </Box>\n                    {!loading ?\n                        <Box p={2} m={2}>\n                            <Grid container justify=\"flex-start\" spacing={4}>\n                                {(showNew || showOld) ?\n                                    (showNew ? listings : listings.reverse()).map((listingObj, index) =>\n                                        getListingCard(listingObj, docsID[showNew ? index : docsID.length - 1 - index]))\n                                    :\n                                    (showLow ? listingsPrice : listingsPrice.reverse()).map((listingObj, index) =>\n                                        getListingCard(listingObj, docsID[index]))\n                                }\n                            </Grid>\n                        </Box>\n                        : <h1>Listings Loading...</h1>\n                    }\n                </div>\n            ) : (<h1>We did not find any results for '{searchTerm}'</h1>)}\n        </div>\n    )\n}\n\nfunction listingsRow(listings) {\n    return (\n        <div className=\"listingRow\">\n            {listings.map((listing, index) => {\n                return (\n                    <Link to={{\n                        pathname: \"/DisplayProduct\",\n                        state: [{iD: docsID[index]}]\n                    }}>\n                        <div key={docsID[index].toString()} className=\"product\">\n                            <img src={listing.imgUrl} className='productImage'/>\n                            <p className='productTitle'>{listing.name}</p>\n                            <p className='productPrice'>Price: £{listing.price}</p>\n                        </div>\n                    </Link>\n                )\n            })}\n        </div>\n    )\n}\n\nexport default Search;"]},"metadata":{},"sourceType":"module"}