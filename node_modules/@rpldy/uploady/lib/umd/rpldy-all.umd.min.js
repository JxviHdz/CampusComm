/*!
 * MIT License
 * 
 * Copyright (c) 2021 Yoav Niran
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","react-dom"],t):"object"==typeof exports?exports.rpldy=t(require("react"),require("react-dom")):e.rpldy=t(e.react,e["react-dom"])}(window,(function(e,t){return function(e){function t(t){for(var r,a,i=t[0],c=t[1],l=t[2],s=0,f=[];s<i.length;s++)a=i[s],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&f.push(o[a][0]),o[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(d&&d(t);f.length;)f.shift()();return u.push.apply(u,l||[]),n()}function n(){for(var e,t=0;t<u.length;t++){for(var n=u[t],r=!0,i=1;i<n.length;i++){var c=n[i];0!==o[c]&&(r=!1)}r&&(u.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={main:0},u=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var i=window.webpackJsonprpldy=window.webpackJsonprpldy||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var d=c;return u.push(["MIuT","polyfills"]),n()}({"10TY":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return u}));var r="__rpldy-logger-debug__",o={PENDING:"pending",ADDED:"added",PROCESSING:"processing",UPLOADING:"uploading",CANCELLED:"cancelled",FINISHED:"finished",ABORTED:"aborted"},u={PENDING:"pending",ADDED:"added",UPLOADING:"uploading",CANCELLED:"cancelled",FINISHED:"finished",ERROR:"error",ABORTED:"aborted"}},DVTP:function(e,t,n){"use strict";(function(e){t.a=function(){var t,n;return"production"===(null===(t=e)||void 0===t||null===(n=t.env)||void 0===n?void 0:"production")}}).call(this,n("8oxB"))},Lrr1:function(e,t,n){"use strict";(function(e){n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return d}));var r=n("CtDf"),o=n.n(r),u=n("mHo/"),a=o()("_rpldy-version_"),i=function(){return"0.11.3"},c=function(){return(Object(u.hasWindow)()?window:e)[a]},l=function(){(Object(u.hasWindow)()?window:e)[a]=i()},d=function(){var e=c();return!!e&&e!==i()}}).call(this,n("8oxB"))},MIuT:function(e,t,n){"use strict";n.r(t),n.d(t,"chunkedSender",(function(){return u})),n.d(t,"lifeEvents",(function(){return a})),n.d(t,"mockSender",(function(){return i})),n.d(t,"retry",(function(){return l})),n.d(t,"safeStorage",(function(){return d})),n.d(t,"sender",(function(){return r})),n.d(t,"shared",(function(){return O})),n.d(t,"simpleState",(function(){return o})),n.d(t,"tusSender",(function(){return s})),n.d(t,"uploader",(function(){return c})),n.d(t,"chunkedUploady",(function(){return g})),n.d(t,"retryHooks",(function(){return v})),n.d(t,"sharedUi",(function(){return f})),n.d(t,"tusUploady",(function(){return h})),n.d(t,"uploadButton",(function(){return b})),n.d(t,"uploadDropZone",(function(){return S})),n.d(t,"uploadPaste",(function(){return m})),n.d(t,"uploadPreview",(function(){return E})),n.d(t,"uploadUrlInput",(function(){return T})),n.d(t,"uploady",(function(){return p}));var r={};n.r(r),n.d(r,"default",(function(){return re})),n.d(r,"send",(function(){return ne})),n.d(r,"getXhrSend",(function(){return te})),n.d(r,"XHR_SENDER_TYPE",(function(){return U})),n.d(r,"MissingUrlError",(function(){return q}));var o={};n.r(o),n.d(o,"default",(function(){return xe})),n.d(o,"createState",(function(){return xe})),n.d(o,"unwrap",(function(){return He})),n.d(o,"isProxy",(function(){return Ue})),n.d(o,"isProxiable",(function(){return ke}));var u={};n.r(u),n.d(u,"default",(function(){return nt})),n.d(u,"CHUNK_EVENTS",(function(){return Me})),n.d(u,"CHUNKING_SUPPORT",(function(){return ae})),n.d(u,"CHUNKED_SENDER_TYPE",(function(){return qe})),n.d(u,"CHUNKED_DEFAULT_OPTIONS",(function(){return oe})),n.d(u,"getChunkedEnhancer",(function(){return tt})),n.d(u,"createChunkedSender",(function(){return et})),n.d(u,"getChunkDataFromFile",(function(){return ie}));var a={};n.r(a),n.d(a,"default",(function(){return Gt})),n.d(a,"addLife",(function(){return Gt})),n.d(a,"isLE",(function(){return Dt})),n.d(a,"createLifePack",(function(){return Wt}));var i={};n.r(i),n.d(i,"default",(function(){return tn})),n.d(i,"MOCK_SENDER_TYPE",(function(){return Kt})),n.d(i,"createMockSender",(function(){return $t})),n.d(i,"getMockSenderEnhancer",(function(){return en}));var c={};n.r(c),n.d(c,"default",(function(){return Gn})),n.d(c,"UPLOADER_EVENTS",(function(){return nn})),n.d(c,"DEFAULT_OPTIONS",(function(){return Un})),n.d(c,"composeEnhancers",(function(){return zn})),n.d(c,"createUploader",(function(){return qn})),n.d(c,"send",(function(){return ne})),n.d(c,"getXhrSend",(function(){return te})),n.d(c,"XHR_SENDER_TYPE",(function(){return U})),n.d(c,"MissingUrlError",(function(){return q}));var l={};n.r(l),n.d(l,"default",(function(){return Qn})),n.d(l,"retryEnhancer",(function(){return Qn})),n.d(l,"RETRY_EVENT",(function(){return Kn})),n.d(l,"RETRY_EXT",(function(){return Wn}));var d={};n.r(d),n.d(d,"safeLocalStorage",(function(){return er})),n.d(d,"safeSessionStorage",(function(){return tr}));var s={};n.r(s),n.d(s,"CHUNKING_SUPPORT",(function(){return ae})),n.d(s,"TUS_SENDER_TYPE",(function(){return sr})),n.d(s,"getTusEnhancer",(function(){return Br})),n.d(s,"clearResumables",(function(){return ir})),n.d(s,"TUS_EXT",(function(){return dr})),n.d(s,"default",(function(){return Hr}));var f={};n.r(f),n.d(f,"useBatchAddListener",(function(){return oo})),n.d(f,"useBatchStartListener",(function(){return uo})),n.d(f,"useBatchProgressListener",(function(){return lo})),n.d(f,"useBatchFinishListener",(function(){return ao})),n.d(f,"useBatchCancelledListener",(function(){return io})),n.d(f,"useBatchAbortListener",(function(){return co})),n.d(f,"useItemStartListener",(function(){return so})),n.d(f,"useItemFinishListener",(function(){return fo})),n.d(f,"useItemProgressListener",(function(){return bo})),n.d(f,"useItemCancelListener",(function(){return po})),n.d(f,"useItemErrorListener",(function(){return go})),n.d(f,"useItemAbortListener",(function(){return vo})),n.d(f,"useItemFinalizeListener",(function(){return ho})),n.d(f,"useRequestPreSend",(function(){return So})),n.d(f,"useAllAbortListener",(function(){return mo})),n.d(f,"generateUploaderEventHook",(function(){return eo})),n.d(f,"generateUploaderEventHookWithState",(function(){return $r})),n.d(f,"logWarning",(function(){return to})),n.d(f,"markAsUploadOptionsComponent",(function(){return no})),n.d(f,"getIsUploadOptionsComponent",(function(){return ro})),n.d(f,"assertContext",(function(){return Qr})),n.d(f,"useUploadOptions",(function(){return Eo})),n.d(f,"useAbortItem",(function(){return To})),n.d(f,"useAbortBatch",(function(){return Oo})),n.d(f,"useAbortAll",(function(){return Io})),n.d(f,"NoDomUploady",(function(){return yo})),n.d(f,"UploadyContext",(function(){return Yr})),n.d(f,"createContextApi",(function(){return Xr})),n.d(f,"withRequestPreSendUpdate",(function(){return Ao})),n.d(f,"useUploadyContext",(function(){return Zr})),n.d(f,"useUploady",(function(){return Zr})),n.d(f,"getUploadyVersion",(function(){return Vr.c}));var p={};n.r(p),n.d(p,"default",(function(){return No})),n.d(p,"useFileInput",(function(){return ko})),n.d(p,"Uploady",(function(){return Do})),n.d(p,"UPLOADER_EVENTS",(function(){return nn})),n.d(p,"DEFAULT_OPTIONS",(function(){return Un})),n.d(p,"composeEnhancers",(function(){return zn})),n.d(p,"createUploader",(function(){return qn})),n.d(p,"send",(function(){return ne})),n.d(p,"getXhrSend",(function(){return te})),n.d(p,"XHR_SENDER_TYPE",(function(){return U})),n.d(p,"MissingUrlError",(function(){return q})),n.d(p,"useBatchAddListener",(function(){return oo})),n.d(p,"useBatchStartListener",(function(){return uo})),n.d(p,"useBatchProgressListener",(function(){return lo})),n.d(p,"useBatchFinishListener",(function(){return ao})),n.d(p,"useBatchCancelledListener",(function(){return io})),n.d(p,"useBatchAbortListener",(function(){return co})),n.d(p,"useItemStartListener",(function(){return so})),n.d(p,"useItemFinishListener",(function(){return fo})),n.d(p,"useItemProgressListener",(function(){return bo})),n.d(p,"useItemCancelListener",(function(){return po})),n.d(p,"useItemErrorListener",(function(){return go})),n.d(p,"useItemAbortListener",(function(){return vo})),n.d(p,"useItemFinalizeListener",(function(){return ho})),n.d(p,"useRequestPreSend",(function(){return So})),n.d(p,"useAllAbortListener",(function(){return mo})),n.d(p,"generateUploaderEventHook",(function(){return eo})),n.d(p,"generateUploaderEventHookWithState",(function(){return $r})),n.d(p,"logWarning",(function(){return to})),n.d(p,"markAsUploadOptionsComponent",(function(){return no})),n.d(p,"getIsUploadOptionsComponent",(function(){return ro})),n.d(p,"assertContext",(function(){return Qr})),n.d(p,"useUploadOptions",(function(){return Eo})),n.d(p,"useAbortItem",(function(){return To})),n.d(p,"useAbortBatch",(function(){return Oo})),n.d(p,"useAbortAll",(function(){return Io})),n.d(p,"NoDomUploady",(function(){return yo})),n.d(p,"UploadyContext",(function(){return Yr})),n.d(p,"createContextApi",(function(){return Xr})),n.d(p,"withRequestPreSendUpdate",(function(){return Ao})),n.d(p,"useUploadyContext",(function(){return Zr})),n.d(p,"useUploady",(function(){return Zr})),n.d(p,"getUploadyVersion",(function(){return Vr.c})),n.d(p,"FILE_STATES",(function(){return O.FILE_STATES})),n.d(p,"BATCH_STATES",(function(){return O.BATCH_STATES}));var g={};n.r(g),n.d(g,"default",(function(){return Ho})),n.d(g,"ChunkedUploady",(function(){return Fo})),n.d(g,"CHUNK_EVENTS",(function(){return Me})),n.d(g,"useFileInput",(function(){return ko})),n.d(g,"Uploady",(function(){return Do})),n.d(g,"UPLOADER_EVENTS",(function(){return nn})),n.d(g,"DEFAULT_OPTIONS",(function(){return Un})),n.d(g,"composeEnhancers",(function(){return zn})),n.d(g,"createUploader",(function(){return qn})),n.d(g,"send",(function(){return ne})),n.d(g,"getXhrSend",(function(){return te})),n.d(g,"XHR_SENDER_TYPE",(function(){return U})),n.d(g,"MissingUrlError",(function(){return q})),n.d(g,"useBatchAddListener",(function(){return oo})),n.d(g,"useBatchStartListener",(function(){return uo})),n.d(g,"useBatchProgressListener",(function(){return lo})),n.d(g,"useBatchFinishListener",(function(){return ao})),n.d(g,"useBatchCancelledListener",(function(){return io})),n.d(g,"useBatchAbortListener",(function(){return co})),n.d(g,"useItemStartListener",(function(){return so})),n.d(g,"useItemFinishListener",(function(){return fo})),n.d(g,"useItemProgressListener",(function(){return bo})),n.d(g,"useItemCancelListener",(function(){return po})),n.d(g,"useItemErrorListener",(function(){return go})),n.d(g,"useItemAbortListener",(function(){return vo})),n.d(g,"useItemFinalizeListener",(function(){return ho})),n.d(g,"useRequestPreSend",(function(){return So})),n.d(g,"useAllAbortListener",(function(){return mo})),n.d(g,"generateUploaderEventHook",(function(){return eo})),n.d(g,"generateUploaderEventHookWithState",(function(){return $r})),n.d(g,"logWarning",(function(){return to})),n.d(g,"markAsUploadOptionsComponent",(function(){return no})),n.d(g,"getIsUploadOptionsComponent",(function(){return ro})),n.d(g,"assertContext",(function(){return Qr})),n.d(g,"useUploadOptions",(function(){return Eo})),n.d(g,"useAbortItem",(function(){return To})),n.d(g,"useAbortBatch",(function(){return Oo})),n.d(g,"useAbortAll",(function(){return Io})),n.d(g,"NoDomUploady",(function(){return yo})),n.d(g,"UploadyContext",(function(){return Yr})),n.d(g,"createContextApi",(function(){return Xr})),n.d(g,"withRequestPreSendUpdate",(function(){return Ao})),n.d(g,"useUploadyContext",(function(){return Zr})),n.d(g,"useUploady",(function(){return Zr})),n.d(g,"getUploadyVersion",(function(){return Vr.c})),n.d(g,"FILE_STATES",(function(){return O.FILE_STATES})),n.d(g,"BATCH_STATES",(function(){return O.BATCH_STATES})),n.d(g,"useChunkStartListener",(function(){return jo})),n.d(g,"useChunkFinishListener",(function(){return Bo}));var v={};n.r(v),n.d(v,"default",(function(){return Go})),n.d(v,"RETRY_EVENT",(function(){return Kn})),n.d(v,"retryEnhancer",(function(){return Qn})),n.d(v,"useRetry",(function(){return Mo})),n.d(v,"useBatchRetry",(function(){return qo})),n.d(v,"useRetryListener",(function(){return zo}));var h={};n.r(h),n.d(h,"default",(function(){return Vo})),n.d(h,"TusUploady",(function(){return Wo})),n.d(h,"useClearResumableStore",(function(){return Ko})),n.d(h,"useFileInput",(function(){return ko})),n.d(h,"Uploady",(function(){return Do})),n.d(h,"UPLOADER_EVENTS",(function(){return nn})),n.d(h,"DEFAULT_OPTIONS",(function(){return Un})),n.d(h,"composeEnhancers",(function(){return zn})),n.d(h,"createUploader",(function(){return qn})),n.d(h,"send",(function(){return ne})),n.d(h,"getXhrSend",(function(){return te})),n.d(h,"XHR_SENDER_TYPE",(function(){return U})),n.d(h,"MissingUrlError",(function(){return q})),n.d(h,"useBatchAddListener",(function(){return oo})),n.d(h,"useBatchStartListener",(function(){return uo})),n.d(h,"useBatchProgressListener",(function(){return lo})),n.d(h,"useBatchFinishListener",(function(){return ao})),n.d(h,"useBatchCancelledListener",(function(){return io})),n.d(h,"useBatchAbortListener",(function(){return co})),n.d(h,"useItemStartListener",(function(){return so})),n.d(h,"useItemFinishListener",(function(){return fo})),n.d(h,"useItemProgressListener",(function(){return bo})),n.d(h,"useItemCancelListener",(function(){return po})),n.d(h,"useItemErrorListener",(function(){return go})),n.d(h,"useItemAbortListener",(function(){return vo})),n.d(h,"useItemFinalizeListener",(function(){return ho})),n.d(h,"useRequestPreSend",(function(){return So})),n.d(h,"useAllAbortListener",(function(){return mo})),n.d(h,"generateUploaderEventHook",(function(){return eo})),n.d(h,"generateUploaderEventHookWithState",(function(){return $r})),n.d(h,"logWarning",(function(){return to})),n.d(h,"markAsUploadOptionsComponent",(function(){return no})),n.d(h,"getIsUploadOptionsComponent",(function(){return ro})),n.d(h,"assertContext",(function(){return Qr})),n.d(h,"useUploadOptions",(function(){return Eo})),n.d(h,"useAbortItem",(function(){return To})),n.d(h,"useAbortBatch",(function(){return Oo})),n.d(h,"useAbortAll",(function(){return Io})),n.d(h,"NoDomUploady",(function(){return yo})),n.d(h,"UploadyContext",(function(){return Yr})),n.d(h,"createContextApi",(function(){return Xr})),n.d(h,"withRequestPreSendUpdate",(function(){return Ao})),n.d(h,"useUploadyContext",(function(){return Zr})),n.d(h,"useUploady",(function(){return Zr})),n.d(h,"getUploadyVersion",(function(){return Vr.c})),n.d(h,"FILE_STATES",(function(){return O.FILE_STATES})),n.d(h,"BATCH_STATES",(function(){return O.BATCH_STATES}));var b={};n.r(b),n.d(b,"default",(function(){return Qo})),n.d(b,"UploadButton",(function(){return Yo})),n.d(b,"asUploadButton",(function(){return Xo}));var S={};n.r(S),n.d(S,"default",(function(){return eu})),n.d(S,"UploadDropZone",(function(){return $o}));var m={};n.r(m),n.d(m,"withPasteUpload",(function(){return nu})),n.d(m,"default",(function(){return au})),n.d(m,"usePasteUpload",(function(){return uu}));var E={};n.r(E),n.d(E,"PREVIEW_TYPES",(function(){return iu})),n.d(E,"default",(function(){return hu})),n.d(E,"UploadPreview",(function(){return vu}));var T={};n.r(T),n.d(T,"default",(function(){return mu})),n.d(T,"UploadUrlInput",(function(){return Su}));var O=n("mHo/"),I=n("o+MX"),y=n.n(I),A=n("ZbhI"),L=n.n(A),_=n("mnMc"),R=n.n(_),C=n("UtpJ"),D=n.n(C),w=n("kT1S"),P=n.n(w),U="rpldy-sender",k=n("06Pm"),N=n.n(k),F=n("X5/F"),j=n.n(F),B=n("K82H"),H=n.n(B),x=n("P0a4"),M=n.n(x),q=function(e){j()(n,e);var t=H()(n);function n(e){var r;return N()(this,n),(r=t.call(this,"".concat(e," didn't receive upload URL"))).name="MissingUrlError",r}return n}(M()(Error)),z=n("zLi2"),G=n.n(z),W=n("i5y0"),K=n.n(W),V=n("RXMP"),X=n.n(V),Y=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var u,a;e.set?e.set.apply(e,y()(u=[t]).call(u,r)):(e.delete&&e.delete(t),e.append.apply(e,y()(a=[t]).call(a,r)))},Q=function(e,t){var n,r=new FormData;t.params&&X()(n=K()(t.params)).call(n,(function(e){var t=G()(e,2),n=t[0],o=t[1];return Y(r,n,o)}));return function(e,t,n){var r=1===t.length;X()(t).call(t,(function(t,o){var u,a=r?n.paramName:Object(O.isFunction)(n.formatGroupParamName)?n.formatGroupParamName(o,n.paramName):y()(u="".concat(n.paramName,"[")).call(u,o,"]");t.file?Y(e,a,t.file,t.file.name):t.url&&Y(e,a,t.url)}))}(r,e,t),r},Z=[200,201,202,203,204],J=function(e,t,n,r,o){var u,a=(null==o?void 0:o.getRequestData)?o.getRequestData(e,n):function(e,t){var n;if(t.sendWithFormData)O.logger.debugLog("uploady.sender: sending ".concat(e.length," item(s) as form data")),n=Q(e,t);else{if(e.length>1)throw new Error("XHR Sender - Request without form data can only contain 1 item. received ".concat(e.length));var r=e[0];O.logger.debugLog("uploady.sender: sending item ".concat(r.id," as request body")),n=r.file||r.url}return n}(e,n),i=function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,c=arguments.length>2?arguments[2]:void 0;c=Object(O.merge)(P()(P()({},Object(O.pick)(n,["method","headers","withCredentials"])),{},{preSend:function(t){t.upload.onprogress=function(t){t.lengthComputable&&r&&r(t,D()(e).call(e))}}}),c);var l=Object(O.request)(o,i,c);return u=l.xhr,l},c=(null==o?void 0:o.preRequestHandler)?o.preRequestHandler(i,e,t,n,r,o):i();return{url:t,count:e.length,pXhr:c,getXhr:function(){return u},aborted:!1}},$=function(e,t,n){var r=e,o=null==t?void 0:t["content-type"];if(n.forceJsonResponse||(null==o?void 0:R()(o).call(o,"json")))try{r=JSON.parse(e)}catch(e){}return r},ee=function(e,t){return e.pXhr.then((function(e){var n,r,o,u;O.logger.debugLog("uploady.sender: received upload response ",e),o=~L()(Z).call(Z,e.status)?O.FILE_STATES.FINISHED:O.FILE_STATES.ERROR,u=e.status;var a=Object(O.parseResponseHeaders)(e);return{status:u,state:o,response:{data:null!==(n=null===(r=t.formatServerResponse)||void 0===r?void 0:r.call(t,e.response,u,a))&&void 0!==n?n:$(e.response,a,t),headers:a}}})).catch((function(t){var n,r;return e.aborted?(n=O.FILE_STATES.ABORTED,r="aborted"):(O.logger.debugLog("uploady.sender: upload failed: ",t),n=O.FILE_STATES.ERROR,r=t),{error:!0,state:n,response:r,status:0}}))},te=function(e){return function(t,n,r,o){if(!n)throw new q(U);O.logger.debugLog("uploady.sender: sending file: ",{items:t,url:n,options:r});var u=J(t,n,r,o,e);return{request:ee(u,r),abort:function(){return function(e){var t,n=!1,r=e.aborted,o=(0,e.getXhr)();!r&&o&&o.readyState&&4!==o.readyState&&(O.logger.debugLog(y()(t="uploady.sender: cancelling request with ".concat(e.count," items to: ")).call(t,e.url)),o.abort(),e.aborted=!0,n=!0);return n}(u)},senderType:U}}},ne=te(),re=ne,oe=Object(O.devFreeze)({chunked:!0,chunkSize:5242880,retries:0,parallel:1}),ue=null,ae=(ue=null,Object(O.hasWindow)()&&"Blob"in window&&(ue=D()(Blob.prototype)||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),!!ue),ie=function(e,t,n){var r,o=null===(r=ue)||void 0===r?void 0:r.call(e,t,n,e.type);return o&&(o.name=e.name,o.lastModified=e.lastModified),o},ce=n("OBge"),le=n.n(ce),de=n("KYsz"),se=n.n(de),fe=n("+oHS"),pe=n.n(fe),ge=n("sLxP"),ve=n.n(ge),he=n("FLGM"),be=n.n(he),Se=function(e){j()(n,e);var t=H()(n);function n(e){var r;return N()(this,n),(r=t.call(this,e)).name="ChunkedSendError",r}return n}(M()(Error)),me=n("M5Mt"),Ee=n.n(me),Te=n("TEMH"),Oe=n.n(Te),Ie=n("LYCE"),ye=n.n(Ie),Ae=n("CtDf"),Le=n.n(Ae),_e=Le()("__rpldy-sstt-proxy__"),Re=Le()("__rpldy-sstt-state__"),Ce=n("6UaR"),De=n.n(Ce),we=n("OWCx"),Pe=n.n(we),Ue=function(e){var t;return!Object(O.isProduction)()&&!!e&&!!~L()(t=Pe()(e)).call(t,_e)},ke=function(e){return De()(e)||Object(O.isPlainObject)(e)&&!function(e){return Object(O.hasWindow)()&&e instanceof File||e.name&&e.size&&e.uri}(e)},Ne=Object(O.getMerge)({withSymbols:!0,predicate:function(e){return e!==_e&&e!==Re}}),Fe=function(e){return!!Object(O.isProduction)()||e[Re].isUpdateable},je=function(e,t){Object(O.isProduction)()||(e[Re].isUpdateable=t)},Be=function(e,t){var n,r;ke(e)&&(Ue(e)||(e[_e]=!0,n=new Proxy(e,t)),X()(r=pe()(e)).call(r,(function(n){e[n]=Be(e[n],t)})));return n||e},He=function(e){return Ue(e)?Object(O.clone)(e,Ne):e},xe=function(e){var t={set:function(e,r,o){return Fe(n)&&(e[r]=Be(o,t)),!0},get:function(e,t){return t===_e?He(e):e[t]},defineProperty:function(){throw new Error("Simple State doesnt support defining property")},setPrototypeOf:function(){throw new Error("Simple State doesnt support setting prototype")},deleteProperty:function(e,t){return Fe(n)&&delete e[t],!0}};Object(O.isProduction)()||Ue(e)||ye()(e,Re,{value:{isUpdateable:!1},configurable:!0});var n=Object(O.isProduction)()?e:Be(e,t);return{state:n,update:function(e){if(!Object(O.isProduction)()&&Fe(n))throw new Error("Can't call update on State already being updated!");try{je(n,!0),e(n)}finally{je(n,!1)}return n},unwrap:function(e){return e?He(e):Ue(n)?He(n):n}}},Me=Object(O.devFreeze)({CHUNK_START:"CHUNK_START",CHUNK_FINISH:"CHUNK_FINISH"}),qe="rpldy-chunked-sender",ze=function(e,t,n,r,o){return e.requests[n]={id:n,abort:r.abort},r.request.then((function(r){var u;O.logger.debugLog("chunkedSender: request finished for chunk: ".concat(n," - "),r),delete e.requests[n];var a=Oe()(u=e.chunks).call(u,(function(e){return e.id===n}));if(~a){if(r.state===O.FILE_STATES.FINISHED){var i,c=Ee()(i=e.chunks).call(i,a,1);o(Me.CHUNK_FINISH,{chunk:Object(O.pick)(c[0],["id","start","end","index","attempt"]),item:He(t),uploadData:r})}else r.state!==O.FILE_STATES.ABORTED&&(e.chunks[a].attempt+=1);e.responses.push(r.response)}}))},Ge=function(e,t,n){var r,o;return t&&y()(r=y()(o="bytes ".concat(e.start,"-")).call(o,e.start+t.size-1,"/")).call(r,n.file.size)},We=Object(O.getMerge)({undefinedOverwrites:!0}),Ke=function(e,t,n,r,o){var u,a=P()(P()({},He(t.sendOptions)),{},{headers:P()(P()({},t.sendOptions.headers),{},{"Content-Range":Ge(e,e.data,n)})}),i=Object(O.createBatchItem)(e.data,e.id),c=function(t){r(t,[e])},l=L()(u=t.chunks).call(u,e);return Object(O.triggerUpdater)(o,Me.CHUNK_START,{item:He(n),chunk:Object(O.pick)(e,["id","start","end","index","attempt"]),chunkItem:i,sendOptions:a,url:t.url,chunkIndex:l,chunkCount:t.chunks.length,onProgress:r}).then((function(e){var r,o=!1===e;o&&O.logger.debugLog(y()(r="chunkedSender.sendChunk: received false from CHUNK_START handler - skipping chunk ".concat(l,", item ")).call(r,n.id));return o?{request:le.a.resolve({state:O.FILE_STATES.FINISHED,response:"skipping chunk as instructed by CHUNK_START handler",status:200}),abort:function(){return!0},senderType:"chunk-skipped-sender"}:re([i],(null==e?void 0:e.url)||t.url,We({},a,e&&e.sendOptions),c)}))},Ve=function(e,t){e(t instanceof Se?{state:O.FILE_STATES.ERROR,response:"At least one chunk failed"}:{state:O.FILE_STATES.ERROR,response:t.message})},Xe=function(e,t,n,r){e.finished=!0,n({state:r,response:{results:e.responses}})},Ye=function(e,t,n,r,o,u){return new le.a((function(a,i){try{var c=function(e,t,n,r,o){var u,a,i;if(e.data||(e.data=ie(n.file,e.start,e.end)),!e.data)throw new Se("chunk failure - failed to slice");O.logger.debugLog(y()(u=y()(a=y()(i="chunkedSender.sendChunk: about to send chunk ".concat(e.id," [")).call(i,e.start,"-")).call(a,e.end,"] to: ")).call(u,t.url||""));var c=Ke(e,t,n,r,o);return{request:c.then((function(e){return e.request})),abort:function(){return c.then((function(e){return(0,e.abort)()})),!0},senderType:"chunk-passthrough-sender"}}(o,e,t,n,u);ze(e,t,o.id,c,u).then((function(){a(),function(e,t,n){var r=!e.chunks.length;return e.aborted?(O.logger.debugLog("chunkedSender: chunked upload aborted for item: ".concat(t.id)),Xe(e,0,n,O.FILE_STATES.ABORTED)):r&&!e.error&&(O.logger.debugLog("chunkedSender: chunked upload finished for item: ".concat(t.id),e.responses),Xe(e,0,n,O.FILE_STATES.FINISHED)),r||e.error}(e,t,r)||Qe(e,t,n,r,u)}))}catch(e){i(e)}}))},Qe=function(e,t,n,r,o){if(!e.finished&&!e.aborted){var u=pe()(e.requests).length;if(!u||e.parallel&&e.parallel>u){var a;try{a=function(e){for(var t=[],n=pe()(e.requests),r=e.parallel||1,o=0;o<e.chunks.length&&n.length<r&&t.length<r;o++){var u=e.chunks[o];if(!R()(n).call(n,u.id)){if(u.attempt&&!(u.attempt<e.retries))throw new Se("chunk failure");t.push(u)}}return t}(e)}catch(e){Ve(r,e)}a&&X()(a).call(a,(function(u){Ye(e,t,n,r,u,o).catch((function(t){e.error=!0,Ve(r,t)}))}))}}},Ze=Qe,Je=function(e,t,n,r){var o=Object(O.throttle)((function(r,o){var u,a=o[0].id;e.uploaded[a]=r.loaded;var i=se()(u=pe()(e.uploaded)).call(u,(function(t,n){return t+e.uploaded[n]}),e.chunks[0].start);n({loaded:i,total:t.file.size},[t])}),100,!0);return{sendPromise:new le.a((function(n){Ze(e,t,o,n,r)})),abort:function(){return function(e,t){var n;(O.logger.debugLog("chunkedSender: aborting chunked upload for item: ".concat(t.id)),e.finished||e.aborted)||(X()(n=pe()(e.requests)).call(n,(function(t){O.logger.debugLog("chunkedSender: aborting chunk: ".concat(t)),e.requests[t].abort()})),e.aborted=!0);return e.aborted}(e,t)}}},$e=function(e,t,n,r,o,u){var a,i=function(e,t){var n,r,o,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=t.chunkSize,i=u?e.file.size-u:e.file.size;if(i<=0)throw new Se(y()(o="start byte ".concat(u," is invalid. File size: ")).call(o,e.file.size));var c=i<=a?1:Math.ceil(i/a);return be()(n=ve()(r=new Array(c)).call(r,null)).call(n,(function(t,n){var r,o=a*n+(u||0);return{id:y()(r="".concat(e.id,"_chunk-")).call(r,n),start:o,end:Math.min(o+a,e.file.size),data:null,attempt:0,uploaded:0,index:n}}))}(e,t,r.startByte);O.logger.debugLog(y()(a="chunkedSender: created ".concat(i.length," chunks for: ")).call(a,e.file.name));var c=P()({finished:!1,aborted:!1,error:!1,uploaded:{},requests:{},responses:[],chunks:i,url:n,sendOptions:r},t),l=Je(c,e,o,u);return{request:l.sendPromise,abort:l.abort,senderType:qe}},et=function(e,t){var n=function(e){return Object(O.merge)({},oe,e)}(e);return{send:function(e,r,o,u){var a;return!n.chunked||e.length>1||e[0].url||!e[0].file.size?(a=re(e,r,o,u),O.logger.debugLog("chunkedSender: sending items as normal, un-chunked requests")):(O.logger.debugLog("chunkedSender: sending file as a chunked request"),a=$e(e[0],n,r,o,u,t)),a}}},tt=function(e){return function(t,n){var r=et(e,n);return t.update({send:r.send}),t}},nt=tt,rt=n("04Ix"),ot=n.n(rt),ut=n("RSWj"),at=n.n(ut),it=n("HnXd"),ct=n.n(it),lt=n("Vi3r"),dt=n.n(lt),st=n("5PDf"),ft=n.n(st),pt=n("eLKs"),gt=n.n(pt),vt=n("STz3"),ht=n.n(vt),bt=n("cdeZ"),St=n.n(bt),mt=n("/FZm"),Et=n.n(mt),Tt=n("JlUD"),Ot=n.n(Tt),It=Object(O.devFreeze)({allowRegisterNonExistent:!0,canAddEvents:!0,canRemoveEvents:!0,collectStats:!1}),yt=function(e,t){if(!Object(O.isFunction)(e))throw new Error("'".concat(t,"' is not a valid function"))},At=function(e){return void 0===e},Lt=Le()("__le__"),_t=Le()("__le__pack__"),Rt=function(e){return e?e[Lt]:null},Ct=function(e){var t=Rt(e);if(!t)throw new Error("Didnt find LE internal object. Something very bad happened!");return t},Dt=function(e){return!!Rt(e)},wt=function(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];yt(n,"cb");var u=Ct(e);if(!u.options.allowRegisterNonExistent&&!~L()(r=u.events).call(r,t))throw new Error("Cannot register for event ".concat(t.toString()," that wasn't already defined (allowRegisterNonExistent = false)"));var a=u.registry[t]||[];return Et()(a).call(a,(function(e){return e.cb===n}))||(a.push({name:t,cb:n,once:o}),u.registry[t]=a),function(){return Ht.call(e,t,n)}},Pt=function(e,t){var n,r,o=Ct(e).registry;return t?o[t]?D()(n=o[t]).call(n):[]:St()(r=ht()(o)).call(r)},Ut={on:function(e,t){return wt(this,e,t)},once:function(e,t){return wt(this,e,t,!0)},off:Ht,getEvents:function(){var e;return D()(e=Ct(this).events).call(e)}},kt=function(){var e;return se()(e=K()(Ut)).call(e,(function(e,t){var n=G()(t,2),r=n[0],o=n[1];return e[r]={value:o},e}),{})},Nt={trigger:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var u,a=Pt(this,e);if(a.length){var i,c,l,d;1===r.length&&!0===(null===(i=r[0])||void 0===i?void 0:i[_t])&&(d=r[0].resolve()),u=be()(c=ft()(l=be()(a).call(a,(function(n){return n.once&&Bt(t,e,n.cb),d?n.cb.apply(n,dt()(d)):r.length?1===r.length?n.cb(r[0]):2===r.length?n.cb(r[0],r[1]):3===r.length?n.cb(r[0],r[1],r[2]):n.cb.apply(n,r):n.cb()}))).call(l,(function(e){return!At(e)}))).call(c,(function(e){return Ot()(e)?e:le.a.resolve(e)}))}return u&&(u.length?u:void 0)},addEvent:function(e){var t=Ct(this);if(!t.options.canAddEvents)throw new Error("Cannot add new events (canAddEvents = false)");var n;if(~L()(n=t.events).call(n,e))throw new Error("Event '".concat(e,"' already defined"));t.events.push(e)},removeEvent:function(e){var t=Ct(this);if(!t.options.canRemoveEvents)throw new Error("Cannot remove events (canRemoveEvents = false)");var n,r,o=L()(n=t.events).call(n,e);Ee()(r=t.events).call(r,o,1)},hasEvent:function(e){var t,n=Ct(this);return!!~L()(t=n.events).call(t,e)},hasEventRegistrations:function(e){return!!Pt(this,e).length},assign:function(e){var t=Ct(this);return zt(e,t.options,t.events,t.registry,t.stats),Ft(e)}},Ft=function(e){var t;return se()(t=pe()(Nt)).call(t,(function(t,n){var r;return t[n]=gt()(r=Nt[n]).call(r,e),t}),P()({target:e},Nt))},jt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Ct(e).registry;!r[t]||!n&&r[t].length||delete r[t]},Bt=function(e,t,n){var r,o=Ct(e).registry;o[t]&&(n?(o[t]=ft()(r=o[t]).call(r,(function(e){return e.cb!==n})),jt(e,t)):jt(e,t,!0))};function Ht(e,t){Bt(this,e,t)}var xt,Mt,qt,zt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};ct()(e,P()(ot()({},Lt,{value:at()({registry:r,events:n,options:t,stats:o})}),kt()))},Gt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;return e=e||{},n=P()(P()({},It),n),Dt(e)||zt(e,n,t),Ft(e)},Wt=function(e){var t={resolve:function(){var t;return y()(t=[]).call(t,e())}};return ye()(t,_t,{value:!0,configurable:!1}),t},Kt="rpldy-mock-sender",Vt=n("WxoT"),Xt=n.n(Vt),Yt=n("Kwsy"),Qt=n.n(Yt),Zt=Object(O.devFreeze)({delay:500,fileSize:1e6,progressIntervals:[10,25,50,75,99]}),Jt=function(e,t,n){return e.then((function(e){var r;O.logger.debugLog("uploady.mockSender: mock request finished successfully");var o={sendOptions:n,mock:!0,success:!0},u={"x-request-type":"react-uploady.mockSender"},a=t.responseStatus||200;return{status:a,state:O.FILE_STATES.FINISHED,response:P()(P()({},e),{},{headers:u,data:t.response||(null===(r=n.formatServerResponse)||void 0===r?void 0:r.call(n,Xt()(o),a,u))||o})}})).catch((function(e){return O.logger.debugLog("uploady.mockSender: mock request was aborted",e),{status:0,state:O.FILE_STATES.ABORTED,response:"abort"}}))},$t=function(e){var t=P()(P()({},Zt),e);return{send:function(e,n,r,o){O.logger.debugLog("uploady.mockSender: about to make a mock request for items: ",e);var u=function(e,t){var n,r,o=performance.now(),u=[],a=!1,i=!1,c=null,l=null,d=null,s=function(){l&&(X()(l).call(l,(function(e){clearTimeout(e)})),l=null)},f=new le.a((function(t,n){d=n,Qt()((function(){i=!0,t({options:e,time:performance.now()-o,progressEvents:u}),s()}),e.delay||0)}));e.progressIntervals&&(l=be()(r=e.progressIntervals).call(r,(function(n){var r=n/100,o=(e.delay||0)*r;return Qt()((function(){if(!a&&!i&&c){var n={total:e.fileSize||0,loaded:(e.fileSize||0)*r};u.push(n),c(n,t)}}),o)})));return{then:gt()(n=f.then).call(n,f),abort:function(){return a=!0,i=!0,d&&d(),s(),!0},onProgress:function(e){c=e}}}(t,e);return u.onProgress(o),{request:Jt(u,t,r),abort:u.abort,senderType:Kt}},update:function(e){t=P()(P()({},t),e)}}},en=function(e){return function(t){var n=$t(e);return t.update({send:n.send}),t}},tn=$t,nn=Object(O.devFreeze)({BATCH_ADD:"BATCH-ADD",BATCH_START:"BATCH-START",BATCH_PROGRESS:"BATCH_PROGRESS",BATCH_FINISH:"BATCH-FINISH",BATCH_ABORT:"BATCH-ABORT",BATCH_CANCEL:"BATCH-CANCEL",ITEM_START:"FILE-START",ITEM_CANCEL:"FILE-CANCEL",ITEM_PROGRESS:"FILE-PROGRESS",ITEM_FINISH:"FILE-FINISH",ITEM_ABORT:"FILE-ABORT",ITEM_ERROR:"FILE-ERROR",ITEM_FINALIZE:"FILE-FINALIZE",REQUEST_PRE_SEND:"REQUEST_PRE_SEND",ALL_ABORT:"ALL_ABORT"}),rn=Object(O.devFreeze)({ITEM_PROGRESS:"ITEM_PROGRESS",BATCH_PROGRESS:"BATCH_PROGRESS"}),on=[O.FILE_STATES.FINISHED,O.FILE_STATES.ERROR,O.FILE_STATES.CANCELLED,O.FILE_STATES.ABORTED],un=[O.BATCH_STATES.ADDED,O.BATCH_STATES.PROCESSING,O.BATCH_STATES.UPLOADING],an=[O.BATCH_STATES.ABORTED,O.BATCH_STATES.CANCELLED,O.BATCH_STATES.FINISHED],cn=function(e,t){return e.batches[t].batch},ln=function(e,t,n){return e.getState().items[t].batchId===n},dn=function(e,t){var n=e.getState(),r=n.items[t];return n.batches[r.batchId]},sn=function(e,t){return dn(e,t).batch},fn=function(e,t){var n=function(e,t){return cn(e.getState(),t)}(e,t);e.updateState((function(e){var t;X()(t=n.items).call(t,(function(t){var n,r=t.id;delete e.items[r];var o,u=L()(n=e.itemQueue).call(n,r);~u&&Ee()(o=e.itemQueue).call(o,u,1)}))}))},pn=function(e,t){e.updateState((function(e){delete e.batches[t]}))},gn=function(e,t,n){var r,o=e.getState(),u=cn(o,t),a=o.items,i=P()(P()({},He(u)),{},{items:be()(r=u.items).call(r,(function(e){var t=e.id;return He(a[t])}))});e.trigger(n,i)},vn=function(e,t){var n=sn(e,t);return R()(un).call(un,n.state)},hn=function(e){return R()(an).call(an,e.state)},bn=(xt={},ot()(xt,O.FILE_STATES.PENDING,null),ot()(xt,O.FILE_STATES.ADDED,nn.ITEM_START),ot()(xt,O.FILE_STATES.FINISHED,nn.ITEM_FINISH),ot()(xt,O.FILE_STATES.ERROR,nn.ITEM_ERROR),ot()(xt,O.FILE_STATES.CANCELLED,nn.ITEM_CANCEL),ot()(xt,O.FILE_STATES.ABORTED,nn.ITEM_ABORT),ot()(xt,O.FILE_STATES.UPLOADING,nn.ITEM_PROGRESS),xt),Sn=function(e){return!!~L()(on).call(on,e.state)},mn=function(e,t,n){return X()(t).call(t,(function(t){var n,r=e.getState(),o=t.id,u=t.info;if(O.logger.debugLog("uploader.processor.queue: request finished for item - ",{id:o,info:u}),r.items[o]){e.updateState((function(e){var t=e.items[o];t.state=u.state,t.uploadResponse=u.response,t.uploadStatus=u.status,Sn(t)&&delete e.aborts[o]}));var a=e.getState().items[o];u.state===O.FILE_STATES.FINISHED&&a.completed<100&&e.handleItemProgress(a,100,a.file?a.file.size:0),bn[a.state]&&e.trigger(bn[a.state],a),Sn(a)&&(!function(e,t){e.updateState((function(e){e.batches[t].finishedCounter+=1}))}(e,a.batchId),e.trigger(nn.ITEM_FINALIZE,a))}var i=L()(n=r.itemQueue).call(n,o);~i&&e.updateState((function(e){var t,n;Ee()(t=e.itemQueue).call(t,i,1);var r,u=L()(n=e.activeIds).call(n,o);~u&&Ee()(r=e.activeIds).call(r,u,1)}))})),function(e){var t,n=e.getState();X()(t=pe()(n.batches)).call(t,(function(t){var r=n.batches[t],o=r.batch,u=r.finishedCounter,a=o.orgItemCount,i=hn(o);a===u&&(e.updateState((function(e){var n=cn(e,t);n.state=i?n.state:O.BATCH_STATES.FINISHED,e.currentBatch===t&&(e.currentBatch=null)})),O.logger.debugLog("uploady.uploader.batchHelpers: cleaning up batch: ".concat(o.id)),i||gn(e,t,nn.BATCH_FINISH),fn(e,t),pn(e,t))}))}(e),n(e)},En=Object(O.getMerge)({undefinedOverwrites:!0}),Tn=function(e,t){var n=be()(t).call(t,(function(e){return e.id}));return e.updateState((function(e){var t;e.activeIds=y()(t=e.activeIds).call(t,n)})),function(e,t,n){return Object(O.triggerUpdater)(e.trigger,nn.REQUEST_PRE_SEND,{items:t,options:n}).then((function(e){if(e){if(O.logger.debugLog("uploader.queue: REQUEST_PRE_SEND event returned updated items/options",e),e.items){if(e.items.length!==t.length||!Object(O.isSamePropInArrays)(e.items,t,["id","batchId","recycled"]))throw new Error("REQUEST_PRE_SEND event handlers must return same items with same ids");t=e.items}e.options&&(n=En({},n,e.options))}return{items:t,options:n,cancelled:!1===e}}))}(e,t,e.getState().batches[t[0].batchId].batchOptions).then((function(n){if(!n.cancelled){var r;e.updateState((function(e){var r;X()(r=n.items).call(r,(function(t){e.items[t.id]=t})),e.batches[t[0].batchId].batchOptions=n.options}));var o=e.getState();n.items=be()(r=n.items).call(r,(function(e){return o.items[e.id]})),n.options=o.batches[t[0].batchId].batchOptions}return n}))},On=function(e,t,n){var r,o=t.items,u=t.options,a=e.getState().batches[o[0].batchId].batch;try{r=e.sender.send(o,a,u)}catch(e){O.logger.debugLog("uploader.queue: sender failed with unexpected error",e),r={request:le.a.resolve({status:0,state:O.FILE_STATES.ERROR,response:e.message}),abort:function(){return!1},senderType:"exception-handler"}}return function(e,t,n){e.updateState((function(e){X()(t).call(t,(function(t){e.items[t.id].state=O.FILE_STATES.UPLOADING,e.aborts[t.id]=n.abort}))}))}(e,o,r),r.request.then((function(t){var r=be()(o).call(o,(function(e){return{id:e.id,info:t}}));mn(e,r,n)}))},In=function(e,t,n){var r=e.getState(),o=ht()(r.items);return o=ft()(o).call(o,(function(e){return!!~L()(t).call(t,e.id)})),le.a.all(be()(o).call(o,(function(t){return e.runCancellable(nn.ITEM_START,t)}))).then((function(t){var n;return{allowedItems:ft()(n=be()(t).call(t,(function(t,n){return t?null:function(e,t){return t.getState().items[e]}(o[n].id,e)}))).call(n,Boolean),cancelledResults:t}})).then((function(r){var u=r.allowedItems,a=r.cancelledResults;return(u.length?Tn(e,u).then():le.a.resolve()).then((function(r){var u;return r&&(r.cancelled?a=be()(t).call(t,(function(){return!0})):On(e,r,n)),function(e,t,n,r){var o,u=ft()(o=be()(n).call(n,(function(e,n){return e?t[n].id:null}))).call(o,Boolean);if(u.length){var a=be()(u).call(u,(function(e){return{id:e,info:{status:0,state:O.FILE_STATES.CANCELLED,response:"cancel"}}}));mn(e,a,r)}return!!u.length}(e,o,a,n)||(u=n(e)),u}))}))},yn=function(e,t){var n,r;return!!~L()(n=St()(r=e.getState().activeIds).call(r)).call(n,t)},An=function(e){var t,n=e.getState().itemQueue,r=function(e){for(var t=e.getState(),n=t.itemQueue,r=t.items,o=0,u=n[o];u&&(yn(e,u)||!vn(e,u)||r[u].state!==O.FILE_STATES.ADDED);)u=n[o+=1];return u?o:-1}(e),o=n[r];if(o){var u=dn(e,o),a=u.batch.id,i=u.batchOptions.maxGroupSize||0;if(u.batchOptions.grouped&&i>1){t=[];for(var c=!0;t.length<i&&c;)t.push(o),c=(o=n[r+t.length])&&ln(e,o,a)}else t=[o]}return t},Ln=function(e){var t=An(e),n=le.a.resolve();if(t){var r=e.getCurrentActiveCount(),o=e.getOptions(),u=o.concurrent,a=void 0===u?0:u,i=o.maxConcurrent;if(!r||a&&r<(void 0===i?0:i)){O.logger.debugLog("uploader.processor: Processing next upload - ",{ids:t,state:e.getState(),currentCount:r});var c=!1,l=le.a.resolve(!1);(function(e,t){var n=sn(e,t);return e.getState().currentBatch!==n.id})(e,t[0])&&(l=function(e,t){var n=sn(e,t);return e.runCancellable(nn.BATCH_START,n).then((function(t){return t||e.updateState((function(e){e.currentBatch=n.id})),!t}))}(e,t[0]).then((function(n){return(c=!n)&&(!function(e,t){var n=sn(e,t),r=n.id;O.logger.debugLog("uploady.uploader.batchHelpers: cancelling batch: ",{batch:n}),e.updateState((function(e){cn(e,r).state=O.BATCH_STATES.CANCELLED})),gn(e,r,nn.BATCH_CANCEL),fn(e,r),pn(e,r)}(e,t[0]),Ln(e)),c}))),n=l.then((function(n){n||In(e,t,Ln)}))}}return n},_n=Ln,Rn=function(e,t,n){return O.logger.debugLog("uploader.queue: aborting ".concat(t.state," item  - "),t),mn(e,[{id:t.id,info:{status:0,state:O.FILE_STATES.ABORTED,response:"aborted"}}],n),!0},Cn=(Mt={},ot()(Mt,O.FILE_STATES.UPLOADING,(function(e,t){return O.logger.debugLog("uploader.queue: aborting uploading item  - ",t),e.getState().aborts[t.id]()})),ot()(Mt,O.FILE_STATES.ADDED,Rn),ot()(Mt,O.FILE_STATES.PENDING,Rn),Mt),Dn=function(e,t,n){var r=e.getState().items[t],o=null==r?void 0:r.state;return!!Cn[o]&&Cn[o](e,r,n)},wn=function(e,t,n,r,o){var u=xe({itemQueue:[],currentBatch:null,batches:{},items:{},activeIds:[],aborts:{}}),a=u.state,i=u.update,c=function(){return a},l=function(e){i(e)},d=function(e){if(a.items[e.id]&&!e.recycled)throw new Error("Uploader queue conflict - item ".concat(e.id," already exists"));e.recycled&&function(e,t){var n=t.previousBatch;if(t.recycled&&n&&e.getState().batches[n]){var r=sn(e,t.id).id;r===n&&e.updateState((function(e){var n,o,u=cn(e,r),a=Oe()(n=u.items).call(n,(function(e){return e.id===t.id}));~a&&Ee()(o=u.items).call(o,a,1)}))}}(f,e),l((function(t){t.items[e.id]=e,t.itemQueue.push(e.id)}))},s=function(e,n,r){a.items[e.id]&&(l((function(t){var o=t.items[e.id];o.loaded=r,o.completed=n})),t(nn.ITEM_PROGRESS,c().items[e.id]))};r.on(rn.ITEM_PROGRESS,s),r.on(rn.BATCH_PROGRESS,(function(e){var n,r=null===(n=a.batches[e.id])||void 0===n?void 0:n.batch.items;if(r){var o=se()(r).call(r,(function(e,t){return e[0]+=t.completed,e[1]+=t.loaded,e}),[0,0]),u=G()(o,2),i=u[0],c=u[1];l((function(t){var n=t.batches[e.id].batch;n.completed=i/r.length,n.loaded=c})),t(nn.BATCH_PROGRESS,a.batches[e.id].batch)}}));var f={uploaderId:o,getOptions:function(){return e},getCurrentActiveCount:function(){return a.activeIds.length},getState:c,updateState:l,trigger:t,runCancellable:function(e){var t;if(!Object(O.isFunction)(n))throw new Error("cancellable is of wrong type");for(var r=arguments.length,o=new Array(r>1?r-1:0),u=1;u<r;u++)o[u-1]=arguments[u];return n.apply(void 0,y()(t=[e]).call(t,o))},sender:r,handleItemProgress:s};return Object(O.hasWindow)()&&O.logger.isDebugOn()&&(window["__rpldy_".concat(o,"_queue_state")]=f),{updateState:l,getState:f.getState,runCancellable:f.runCancellable,uploadBatch:function(e,t){t&&l((function(n){n.batches[e.id].batchOptions=t})),_n(f)},addBatch:function(e,t){var n;return l((function(n){n.batches[e.id]={batch:e,batchOptions:t,finishedCounter:0}})),X()(n=e.items).call(n,d),cn(a,e.id)},abortItem:function(e){return function(e,t,n){return Dn(e,t,n)}(f,e,_n)},abortBatch:function(e){!function(e,t,n){var r,o=e.getState().batches[t],u=null==o?void 0:o.batch;u&&!hn(u)&&(e.updateState((function(e){cn(e,t).state=O.BATCH_STATES.ABORTED})),gn(e,t,nn.BATCH_ABORT),X()(r=u.items).call(r,(function(t){return Dn(e,t.id,n)})))}(f,e,_n)},abortAll:function(){var e,t,n,r;t=_n,r=(e=f).getState().items,X()(n=pe()(r)).call(n,(function(n){return Dn(e,n,t)})),e.trigger(nn.ALL_ABORT)},clearPendingBatches:function(){var e,t,n,r;r=(e=f).getState().batches,X()(t=ft()(n=pe()(r)).call(n,(function(e){return r[e].batch.state===O.BATCH_STATES.PENDING}))).call(t,(function(t){fn(e,t),pn(e,t)}))},uploadPendingBatches:function(e){!function(e,t){e.updateState((function(e){var n;X()(n=pe()(e.batches)).call(n,(function(n){var r,o=e.batches[n],u=o.batch,a=o.batchOptions;u.state===O.BATCH_STATES.PENDING&&(X()(r=u.items).call(r,(function(e){e.state=O.FILE_STATES.ADDED})),u.state=O.BATCH_STATES.ADDED,o.batchOptions=Object(O.merge)({},a,t))}))}))}(f,e),_n(f)}}},Pn=function(){return!0},Un=Object(O.devFreeze)({autoUpload:!0,clearPendingOnAdd:!1,inputFieldName:"file",concurrent:!1,maxConcurrent:2,grouped:!1,maxGroupSize:5,method:"POST",params:{},fileFilter:Pn,forceJsonResponse:!1,withCredentials:!1,destination:{},send:null,sendWithFormData:!0}),kn=function(e,t,n,r){!function(e,t,n,r){X()(e).call(e,(function(e){var o,u;O.logger.debugLog(y()(o=y()(u="uploady.uploader.processor: file: ".concat(e.id," progress event: loaded(")).call(u,n,") - completed(")).call(o,t,")")),r(rn.ITEM_PROGRESS,e,t,n)}))}(e,Math.min(n.loaded/n.total*100,100)/e.length,n.loaded/e.length,r),r(rn.BATCH_PROGRESS,t)},Nn=function(){var e=Gt({send:function(e,n,r){var o=r.destination,u=null==o?void 0:o.url,a=Object(O.throttle)((function(r){return kn(e,n,r,t)}),50,!0);return(Object(O.isFunction)(r.send)?r.send:re)(e,u,{method:(null==o?void 0:o.method)||r.method||Un.method,paramName:(null==o?void 0:o.filesParamName)||r.inputFieldName||"file",params:P()(P()({},r.params),null==o?void 0:o.params),forceJsonResponse:r.forceJsonResponse,withCredentials:r.withCredentials,formatGroupParamName:r.formatGroupParamName,headers:null==o?void 0:o.headers,sendWithFormData:r.sendWithFormData,formatServerResponse:r.formatServerResponse},a)}},ht()(rn)),t=e.trigger;return e.target},Fn=Object(O.hasWindow)()&&"FileList"in window,jn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e;if(!Object(O.isProduction)())if(t<3&&Ue(e))n=He(e);else if(t<3&&ke(e)){var r,o;n=De()(e)?be()(r=pe()(e)).call(r,(function(t){return jn(e[t])})):se()(o=pe()(e)).call(o,(function(n,r){return n[r]=jn(e[r],t+1),n}),{})}return n},Bn=0,Hn=function(e,t,n){var r="batch-".concat(Bn+=1),o=function(e){return Fn&&e instanceof FileList||"[object FileList]"===e.toString()}(e);e=De()(e)||o?e:[e];var u=!n.autoUpload,a=function(e,t,n,r){var o;return be()(o=ft()(Array.prototype).call(t,r||Pn)).call(o,(function(t){return Object(O.createBatchItem)(t,e,n)}))}(r,e,u,n.fileFilter);return{id:r,uploaderId:t,items:a,state:u?O.BATCH_STATES.PENDING:O.BATCH_STATES.ADDED,completed:0,loaded:0,orgItemCount:a.length}},xn=ht()(nn),Mn=0,qn=function(e){var t="uploader-".concat(Mn+=1),n=!1,r={};O.logger.debugLog("uploady.uploader: creating new instance (".concat(t,")"),{options:e,counter:Mn});var o=function(e){return P()(P()(P()({},Un),e),{},{destination:e&&e.destination?(t=e.destination,P()({params:{}},t)):null});var t}(e),u=function(){f.clearPendingBatches()},a=Gt({id:t,update:function(e){return o=Object(O.merge)({},o,e),c},add:function(e,t){var n=Object(O.merge)({},o,t);n.clearPendingOnAdd&&u();var r,a=f.addNewBatch(e,c.id,n);return a.items.length?r=f.runCancellable(nn.BATCH_ADD,a,n).then((function(e){var t;e?(a.state=O.BATCH_STATES.CANCELLED,l(nn.BATCH_CANCEL,a)):(O.logger.debugLog(y()(t="uploady.uploader [".concat(c.id,"]: new items added - auto upload =\n                        ")).call(t,String(n.autoUpload)),a.items),n.autoUpload&&f.process(a))})):O.logger.debugLog("uploady.uploader: no items to add. batch ".concat(a.id," is empty. check fileFilter if this isn't intended")),r||le.a.resolve()},upload:function(e){f.processPendingBatches(e)},abort:function(e){f.abort(e)},abortBatch:function(e){f.abortBatch(e)},getOptions:function(){return Object(O.clone)(o)},clearPending:u,registerExtension:function(e,t){Object(O.invariant)(n,"Uploady - uploader extensions can only be registered by enhancers"),Object(O.invariant)(!r[e],"Uploady - uploader extension by this name [%s] already exists",e),O.logger.debugLog("uploady.uploader: registering extension: ".concat(e.toString()),t),r[e]=t},getExtension:function(e){return r[e]}},xn,{canAddEvents:!1,canRemoveEvents:!1}),i=a.trigger,c=a.target,l=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=Wt((function(){return be()(n).call(n,jn)}));return i(e,o)},d=Object(O.triggerCancellable)(l);if(o.enhancer){n=!0;var s=o.enhancer(c,l);n=!1,c=s||c}var f=function(e,t,n,r){var o=Nn(),u=wn(n,e,t,o,r);return{process:function(e,t){u.uploadBatch(e,t)},abortBatch:function(e){u.abortBatch(e)},abort:function(e){e?u.abortItem(e):u.abortAll()},addNewBatch:function(e,t,n){var r=Hn(e,t,n);return u.addBatch(r,n)},runCancellable:u.runCancellable,clearPendingBatches:function(){u.clearPendingBatches()},processPendingBatches:function(e){u.uploadPendingBatches(e)}}}(l,d,o,c.id);return Object(O.devFreeze)(c)},zn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return se()(t).call(t,(function(e,t){var n;return t.apply(void 0,y()(n=[e]).call(n,r))||e}),e)}},Gn=qn,Wn=Le()("__upldy-retry__"),Kn="RETRY_EVENT",Vn=[O.FILE_STATES.ABORTED,O.FILE_STATES.ERROR],Xn=function(e,t,n,r,o){var u,a=t.getState().failed;r=r||pe()(a);var i,c=ft()(u=be()(r).call(r,(function(e){return a[e]}))).call(u,Boolean);c.length&&(o=P()(P()({},o||null),{},{autoUpload:void 0===(null===(i=o)||void 0===i?void 0:i.autoUpload)||o.autoUpload}),n(Kn,{items:c,options:o}),X()(r).call(r,(function(e){return function(e,t){e.updateState((function(e){var n,r,o=e.failed[t].batchId;delete e.failed[t];var u=L()(n=e.batchIdsMap[o]).call(n,t);Ee()(r=e.batchIdsMap[o]).call(r,u,1),e.batchIdsMap[o].length||delete e.batchIdsMap[o]}))}(t,e)})),e.add(c,o));return!!c.length},Yn=function(e,t,n,r,o){var u;return r?u=function(e,t,n,r,o){return O.logger.debugLog("uploady.retry: about to retry item: ".concat(r)),Xn(e,t,n,[r],o)}(e,t,n,r,o):(O.logger.debugLog("uploady.retry: about to retry all failed item"),u=Xn(e,t,n,null,o)),u},Qn=function(e,t){var n,r,o,u=(n=xe({batchIdsMap:{},failed:{}}),r=n.state,o=n.update,{updateState:function(e){o(e)},getState:function(){return r}});return function(e,t){e.on(nn.ITEM_FINALIZE,(function(e){~L()(Vn).call(Vn,e.state)&&t.updateState((function(t){t.failed[e.id]=e,(t.batchIdsMap[e.batchId]=t.batchIdsMap[e.batchId]||[]).push(e.id)}))}))}(e,u),e.registerExtension(Wn,{retry:function(n,r){return Yn(e,u,t,n,r)},retryBatch:function(n,r){return function(e,t,n,r,o){var u;O.logger.debugLog("uploady.retry: about to retry batch: ".concat(r));var a=null===(u=t.getState().batchIdsMap[r])||void 0===u?void 0:D()(u).call(u);return!!a&&Xn(e,t,n,a,o)}(e,u,t,n,r)}}),e},Zn=n("MAKL"),Jn=n.n(Zn),$n=function(e){var t=!1;!function(){try{if(Object(O.hasWindow)()&&e in window){window[e].setItem("__lsTest","__test-".concat(Jn()())),window[e].removeItem("__lsTest"),t=!0}}catch(e){}}();var n=["key","getItem","setItem","removeItem","clear"],r=se()(n).call(n,(function(n,r){return n[r]=function(){var n;return t?(n=window[e])[r].apply(n,arguments):void 0},n}),{});return r.isSupported=t,ye()(r,"length",{get:function(){return t?window[e].length:0}}),r},er=$n("localStorage"),tr=$n("sessionStorage"),nr=Object(O.devFreeze)(P()(P()({},oe),{},{featureDetection:!1,featureDetectionUrl:null,version:"1.0.0",resume:!0,overrideMethod:!1,deferLength:!1,sendDataOnCreate:!1,storagePrefix:"__rpldy-tus__",lockedRetryDelay:2e3,forgetOnSuccess:!1,ignoreModifiedDateInStorage:!1})),rr=function(e,t,n){var r,o,u=ft()(r=[e.file.name,e.file.type,e.file.size,t.ignoreModifiedDateInStorage?null:e.file.lastModified,n]).call(r,Boolean).join("/");return y()(o="".concat(t.storagePrefix||nr.storagePrefix)).call(o,u)},or=function(e,t,n,r){n.resume&&er.setItem(rr(e,n,r),Xt()({time:Jn()(),uploadUrl:t}))},ur=function(e,t,n){var r,o=rr(e,t,n);if(t.resume)try{var u=er.getItem(o);if(u)r=JSON.parse(u).uploadUrl}catch(e){O.logger.debugLog("tusSender.resumableStore: failed to retrieve persisted data for key: ".concat(o),e)}return r},ar=function(e,t,n){var r=rr(e,t,n);er.removeItem(r)},ir=function(e){for(var t=e.storagePrefix||nr.storagePrefix,n=0;n<er.length;n++){var r=er.key(n);r&&!L()(r).call(r,t)&&er.removeItem(r)}},cr=n("lHQ6"),lr=n.n(cr),dr=Le()("__upldy-tus__"),sr="rpldy-tus-sender",fr=[200,201,204],pr="creation-with-upload",gr="concatenation",vr="creation-defer-length",hr=function(e){var t=e.params&&pe()(e.params);return(null==t?void 0:t.length)?be()(t).call(t,(function(t){var n;return y()(n="".concat(t," ")).call(n,btoa(e.params[t]))})).join(","):void 0},br=function(e,t){return e.then((function(e){return e.state===O.FILE_STATES.FINISHED&&(e.response.location=t),e}))},Sr=function(e,t,n,r,o){var u,a=n.getState().options,i=P()({"tus-resumable":a.version,"Upload-Defer-Length":a.deferLength?1:void 0,"Upload-Length":a.deferLength?void 0:e.file.size,"Upload-Metadata":o?void 0:hr(r),"Content-Type":a.sendDataOnCreate?"application/offset+octet-stream":void 0},r.headers),c=null;if(O.logger.debugLog(y()(u="tusSender.create - creating upload for ".concat(e.id," at: ")).call(u,t)),a.sendDataOnCreate){O.logger.debugLog("tusSender.create - adding first chunk to create request");var l=+a.chunkSize;c=l<e.file.size?ie(e.file,0,l):e.file}var d=Object(O.request)(t,c,{method:"POST",headers:i}),s=!1;return{request:d.then((function(r){var o=null;return r&&~L()(fr).call(fr,r.status)?o=function(e,t,n,r,o){var u,a,i,c=n.getState().options,l=(a=t,i=r.getResponseHeader("Location"),/^(http:|https:)?\/\//.test(i)?i:[a.replace(/\/$/,""),i.replace(/^\//,"")].join("/")),d=0,s=!1;if(O.logger.debugLog(y()(u="tusSender.create: successfully created upload for item: ".concat(e.id," - upload url = ")).call(u,l)),c.sendDataOnCreate){var f=lr()(r.getResponseHeader("Upload-Offset"));d=isNaN(f)?d:f,s=+c.parallel>1&&d===(null==o?void 0:o.size)}return n.updateState((function(t){t.items[e.id].uploadUrl=l,t.items[e.id].offset=d})),{offset:d,uploadUrl:l,isNew:!0,isDone:s}}(e,t,n,r,c):O.logger.debugLog("tusSender.create: create upload failed for item: ".concat(e.id),r),o})).catch((function(e){return O.logger.debugLog("tusSender.create: create upload failed",e),null})).finally((function(){s=!0})),abort:function(){return s||(O.logger.debugLog("tusSender.create: aborting create request for item: ".concat(e.id)),d.xhr.abort()),!s}}},mr=function(e,t,n){return ar(e,t,n),{isNew:!1,canResume:!1}},Er=function(e,t,n,r,o){var u,a,i=n.getState().options;O.logger.debugLog(y()(u=y()(a="tusSender.resume - resuming upload for ".concat(e.id)).call(a,r?"-".concat(r):""," at: ")).call(u,t));var c=Object(O.request)(t,null,{method:"HEAD",headers:{"tus-resumable":i.version}}),l=!1;return{request:c.then((function(u){var a;if(u&&~L()(fr).call(fr,u.status))a=function(e,t,n,r){var o,u=!1,a=!1;O.logger.debugLog(y()(o="tusSender.resume - successfully initiated resume for item: ".concat(e.id," - upload url = ")).call(o,t));var i=lr()(r.getResponseHeader("Upload-Offset"));if(!isNaN(i)){var c=lr()(r.getResponseHeader("Upload-Length"));isNaN(c)&&!n.getState().options.deferLength||(u=!(a=i===c),n.updateState((function(n){n.items[e.id].uploadUrl=t,n.items[e.id].offset=i})))}return{offset:i,uploadUrl:t,isNew:!1,isDone:a,canResume:u}}(e,t,n,u);else if(423===(null==u?void 0:u.status)&&0===o){var c;O.logger.debugLog(y()(c="tusSender.resume: upload is locked for item: ".concat(e.id,". Will retry in ")).call(c,+i.lockedRetryDelay),u),a=function(e,t,n,r,o){return new le.a((function(u){Qt()((function(){Er(e,t,n,r,o).request.then(u)}),n.getState().options.lockedRetryDelay)}))}(e,t,n,r,1)}else{var l;O.logger.debugLog(y()(l="tusSender.resume: failed for item: ".concat(e.id)).call(l,r?"-".concat(r):""),u),a=mr(e,i,r)}return a})).catch((function(t){return O.logger.debugLog("tusSender.resume: resume upload failed unexpectedly",t),mr(e,i,r)})).finally((function(){l=!0})),abort:function(){return l||(O.logger.debugLog("tusSender.resume: aborting resume request for item: ".concat(e.id)),c.xhr.abort()),!l}}},Tr=function(e,t,n,r){return Er(e,t,n,r,0)},Or=function(e,t,n,r,o){return o.then((function(o){var u=o;if(o.state===O.FILE_STATES.FINISHED){var a=n.getState(),i=a.options,c=a.items,l=c[e.id];if(l){var d,s,f=l.parallelChunks,p=be()(d=ft()(f).call(f,(function(e){var t;return null===(t=c[e])||void 0===t?void 0:t.uploadUrl}))).call(d,(function(e){return c[e].uploadUrl}));if(p.length!==f.length)throw new Error(y()(s="tusSender: something went wrong. found ".concat(p.length," upload urls for ")).call(s,f.length," chunks"));var g={"tus-resumable":i.version,"Upload-Concat":"final;".concat(p.join(" ")),"Upload-Metadata":hr(r)};O.logger.debugLog("tusSender.finalizeParallel: sending finalizing request",{url:t,headers:g});var v=Object(O.request)(t,null,{method:"POST",headers:g});n.updateState((function(t){t.items[e.id].abort=function(){return v.xhr.abort(),!0}})),u=function(e,t){return e.catch((function(e){return O.logger.debugLog("tusSender.finalizeParallel: finalize request failed unexpectedly!",e),e})).then((function(e){var n,r=(null==e?void 0:e.status)||0,o=!!~L()(fr).call(fr,r),u=o&&(null==e?void 0:e.getResponseHeader)&&e.getResponseHeader("Location");return u?(O.logger.debugLog("tusSender.finalizeParallel: successfully finalized parallel upload",u),n=br(le.a.resolve(t),u)):(O.logger.debugLog("tusSender.finalizeParallel: parallel upload finalize failed!",r),n={status:r,state:O.FILE_STATES.ERROR,response:{message:(null==e?void 0:e.response)||(o&&!u?"No valid location header for finalize request":"")}}),n}))}(v,o)}}return u}))},Ir=function(e,t,n,r,o,u,a,i,c){return a.then((function(a){var l,d=!1;if(a?a.isDone?(O.logger.debugLog("tusSender.handler: resume found server has completed file for item: ".concat(e[0].id),e[0]),l=br(le.a.resolve({status:200,state:O.FILE_STATES.FINISHED,response:{message:"TUS server has file"}}),a.uploadUrl)):a.isNew||a.canResume?l=c?function(e,t,n,r){var o=e[0];return n.uploadUrl&&or(o,n.uploadUrl,t.getState().options,r),O.logger.debugLog("tusSender.handler: created upload for parallelized chunk: ".concat(o.id)),le.a.resolve({status:200,state:O.FILE_STATES.UPLOADING,response:"TUS server created upload for parallelized part"})}(e,o,a,c):function(e,t,n,r,o,u,a){var i=o.getState().options,c=e[0];O.logger.debugLog("tusSender.handler: init request finished. sending item ".concat(c.id," as chunked"),a),a.isNew&&a.uploadUrl&&or(c,a.uploadUrl,i),(a.canResume||i.sendDataOnCreate&&a.offset)&&(n=P()(P()({},n),{},{startByte:a.offset}));var l=u.send(e,t,n,r);return o.updateState((function(e){e.items[c.id].abort=l.abort})),+i.parallel>1?Or(c,t,o,n,l.request):br(l.request,a.uploadUrl)}(e,t,n,r,o,u,a):d=!0:d=i,d){O.logger.debugLog("tusSender.handler: resume init failed. Will try creating a new upload for item: ".concat(e[0].id));var s=Sr(e[0],t,o,n).request;l=Ir(e,t,n,r,o,u,s)}return l||le.a.resolve({status:0,state:O.FILE_STATES.ERROR,response:"TUS initialize failed"})}))},yr=Ir,Ar=function(e,t){t.updateState((function(t){t.items[e.id]={id:e.id,uploadUrl:null,size:e.file.size,offset:0,parallelChunks:[]}}))},Lr=function(e,t,n,r,o,u){var a,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=o.getState(),l=c.options,d=+l.parallel>1&&!i,s=e[0],f=!d&&ur(s,l,i);Ar(s,o),a=d?{request:le.a.resolve({isNew:!0}),abort:function(){return!0}}:f?Tr(s,f,o,i):Sr(s,t,o,n,i);var p=yr(e,t,n,r,o,u,a.request,!!f,i),g=function(){return O.logger.debugLog("tusSender.handler: abort called for item: ".concat(s.id)),a.abort(),a.request.then((function(e){if(e){O.logger.debugLog("tusSender.handler: aborting chunked upload for item:  ".concat(s.id));var t=o.getState().items[s.id].abort;t&&t()}})),!0};return{request:p,abort:g}},_r=function(e,t){var n;return y()(n="_prlChunk_".concat(+e.chunkSize,"_")).call(n,t)},Rr=function(e,t,n){ae&&(e.on(nn.ITEM_FINALIZE,(function(e){var n=t.getState(),r=n.items,o=n.options,u=r[e.id];if(u){var a;O.logger.debugLog(y()(a="tusSender.handleEvents: item ".concat(e.id," finalized (")).call(a,e.state,"). Removing from state"));var i=u.parallelChunks;t.updateState((function(t){i.length&&X()(i).call(i,(function(e){delete t.items[e]})),delete t.items[e.id]})),o.forgetOnSuccess&&(O.logger.debugLog("tusSender.handleEvents: forgetOnSuccess enabled, removing item url from storage: ".concat(e.id)),ar(e,o))}})),e.on(Me.CHUNK_START,(function(e){var r=+t.getState().options.parallel>1;return(r?function(e,t,n){var r=n.item,o=n.chunkItem,u=n.url,a=n.sendOptions,i=n.onProgress,c=n.chunk,l=e.getState().options;return e.updateState((function(e){e.items[r.id].parallelChunks.push(o.id)})),Lr([o],u,P()(P()({},a),{},{params:null}),i,e,t,_r(l,c.index)).request.then((function(e){return e.state!==O.FILE_STATES.FINISHED}))}(t,n,e):le.a.resolve(!0)).then((function(n){return n&&function(e,t,n){var r=t.item,o=t.chunk,u=t.chunkItem,a=t.chunkCount,i=e.getState().options,c=e.getState().items[n?u.id:r.id],l=n?0:c.offset||o.start,d={"tus-resumable":i.version,"Upload-Offset":l,"Content-Type":"application/offset+octet-stream","Content-Range":void 0,"X-HTTP-Method-Override":i.overrideMethod?"PATCH":void 0,"Upload-Length":i.deferLength&&o.index===a-1?r.file.size:void 0,"Upload-Concat":n?"partial":void 0};return O.logger.debugLog("tusSender.handleEvents: chunk start handler. offset = ".concat(l),{headers:d,url:c.uploadUrl}),{sendOptions:{sendWithFormData:!1,method:i.overrideMethod?"POST":"PATCH",headers:d},url:c.uploadUrl}}(t,e,r)}))})),e.on(Me.CHUNK_FINISH,(function(e){var n=e.item,r=e.chunk,o=e.uploadData,u=t.getState(),a=u.items,i=u.options;if(+i.parallel>1){if(i.forgetOnSuccess){var c=_r(i,r.index);O.logger.debugLog("tusSender.handleEvents: forgetOnSuccess enabled, removing parallel chunk url from storage: ".concat(c)),ar(n,i,c)}}else if(a[n.id]){var l,d,s=o.status,f=o.response;O.logger.debugLog(y()(l=y()(d="tusSender.handleEvents: received upload response (code: ".concat(s,") for : ")).call(d,n.id,", chunk: ")).call(l,r.id),f),~L()(fr).call(fr,s)&&f.headers&&t.updateState((function(e){e.items[n.id].offset=f.headers["upload-offset"]}))}})))},Cr=function(e){var t;return y()(t="".concat("rpldy_tus_fd_")).call(t,e)},Dr=(qt={},ot()(qt,gr,(function(e,t){+t.getState().options.parallel>1&&!~L()(e).call(e,gr)&&(O.logger.debugLog("tusSender.featureDetection: disabling parallel uploads, ".concat(gr," extension not available")),t.updateState((function(e){e.options.parallel=1})))})),ot()(qt,pr,(function(e,t){t.getState().options.sendDataOnCreate&&!~L()(e).call(e,pr)&&(O.logger.debugLog("tusSender.featureDetection: disabling create with data, ".concat(pr," extension not available")),t.updateState((function(e){e.options.sendDataOnCreate=!1})))})),ot()(qt,vr,(function(e,t){t.getState().options.deferLength&&!~L()(e).call(e,vr)&&(O.logger.debugLog("tusSender.featureDetection: disabling defer length, ".concat(vr," extension not available")),t.updateState((function(e){e.options.deferLength=!1})))})),qt),wr=function(e,t,n){var r=e.getState().options;if(t){O.logger.debugLog("tusSender.featureDetection: retrieved extensions from server",t);var o=t.split(",");if(o.length&&r.onFeaturesDetected){var u=r.onFeaturesDetected(o);u&&e.updateState((function(e){e.options=Object(O.merge)({},e.options,u)}))}else{var a;X()(a=pe()(Dr)).call(a,(function(t){Dr[t](o,e)}))}}n&&n!==e.getState().options.version&&(O.logger.debugLog("tusSender.featureDetection: setting version to server version: ".concat(n)),e.updateState((function(e){e.options.version=n}))),e.updateState((function(e){e.featureDetection={processed:!0,version:n,extensions:t}}))},Pr=function(e,t,n){return e.catch((function(e){O.logger.debugLog("tusSender.featureDetection: failed to retrieve data from server",e)})).then((function(e){if(e&&~L()(fr).call(fr,e.status)){var r=e.getResponseHeader("Tus-Extension"),o=e.getResponseHeader("Tus-Resumable");r&&tr.setItem(Cr(t),Xt()({extensions:r,versions:o})),wr(n,r,o)}}))},Ur=function(e,t){var n=t.getState().options,r=Object(O.request)(e,null,{method:"OPTIONS",headers:{"tus-resumable":n.version}});return{request:Pr(r,e,t),abort:function(){return r.xhr.abort(),!0}}},kr=function(e,t){var n,r=t.getState(),o=r.options,u=r.featureDetection;e=o.featureDetectionUrl||e,O.logger.debugLog("tusSender.featureDetection: about to request server info",e);var a=tr.getItem(Cr(e));return u.processed||(n=a?function(e,t,n){var r;try{(r=JSON.parse(n)).extensions?(O.logger.debugLog("tusSender.featureDetection: retrieved feature detection data from session storage",r),wr(t,r.extensions,r.version)):r=null}catch(e){O.logger.debugLog("tusSender.featureDetection: failed to load feature detection data from session storage")}return r||tr.removeItem(Cr(e)),r?null:Ur(e,t)}(e,t,a):Ur(e,t)),n},Nr=function(e,t){return ae?function(n,r,o,u){var a;if(!r)throw new q(sr);if(n.length>1||n[0].url)a=e.send(n,r,o,u);else{O.logger.debugLog("tusSender: sending file using TUS protocol");var i=t.getState().options.featureDetection?kr(r,t):null,c=function(e,t,n,r,o,u,a){var i,c=function(){var a=Lr(e,t,n,r,o,u);return i=a.abort,a.request};return{request:a?a.request.then(c,c):c(),abort:function(){return i?i():(null==a?void 0:a.abort())||!1}}}(n,r,o,u,t,e,i);a={request:c.request,abort:c.abort,senderType:sr}}return a}:re},Fr=function(e){return((e=function(e){return Object(O.merge)({},nr,e)}(e)).sendDataOnCreate||e.parallel)&&e.deferLength&&(O.logger.debugLog("tusSender: turning off deferLength - cannot be used when sendDataOnCreate or parallel is enabled"),e.deferLength=!1),e.chunked=!0,e},jr=function(e,t,n){t=Fr(t);var r=et(t,n),o=function(e,t){var n=xe({options:t,items:{},featureDetection:{extensions:null,version:null,processed:!1}}),r=n.state,o={getState:function(){return r},updateState:n.update};return Object(O.hasWindow)()&&O.logger.isDebugOn()&&(window["__rpldy_".concat(e.id,"_tus_state")]=o),o}(e,t);return Rr(e,o,r),{send:Nr(r,o),getOptions:function(){return o.getState().options}}},Br=function(e){return function(t,n){var r=jr(t,e,n);return t.update({send:r.send}),t.registerExtension(dr,{getOptions:r.getOptions}),t}},Hr=Br,xr=n("EcSs"),Mr=n.n(xr),qr=n("tpxy"),zr=n.n(qr),Gr=n("cDcd"),Wr=n.n(Gr),Kr=Le()("rpldy_component"),Vr=n("Lrr1"),Xr=function(e,t){var n,r;t?n=t:O.logger.debugLog("Uploady context - didn't receive input field ref - waiting for external ref");var o=function(){var e;return null===(e=n)||void 0===e?void 0:e.current},u=function(){var e=o();Object(O.invariant)(e,"Uploady - Context. File input isn't available"),e.removeEventListener("change",u);var t=r;r=null,a(e.files,t)},a=function(t,n){e.add(t,n)};return Object(Vr.d)(),{hasUploader:function(){return!!e},setExternalFileInput:function(e){n=e},showFileUpload:function(e){var t=o();Object(O.invariant)(t,"Uploady - Context. File input isn't available"),r=e,t.removeEventListener("change",u),t.addEventListener("change",u),t.value="",t.click()},upload:a,processPending:function(t){e.upload(t)},clearPending:function(){e.clearPending()},setOptions:function(t){e.update(t)},getOptions:function(){return e.getOptions()},getExtension:function(t){return e.getExtension(t)},abort:function(t){e.abort(t)},abortBatch:function(t){e.abortBatch(t)},on:function(t,n){return e.on(t,n)},once:function(t,n){return e.once(t,n)},off:function(t,n){return e.off(t,n)}}},Yr=Wr.a.createContext(null),Qr=function(e){return Object(O.invariant)(!Object(Vr.a)(),"Uploady - Valid UploadyContext not found.\nYou may be using packages of different Uploady versions. <Uploady> and all other packages using the context provider must be of the same version: %s",Object(Vr.b)()),Object(O.invariant)(e&&e.hasUploader(),"Uploady - Valid UploadyContext not found. Make sure you render inside <Uploady>"),e},Zr=function(){return Qr(Object(Gr.useContext)(Yr))},Jr=function(e,t){var n=Zr(),r=n.on,o=n.off;Object(Gr.useEffect)((function(){return r(e,t),function(){o(e,t)}}),[e,t,r,o])},$r=function(e,t){return function(n,r){var o=Object(Gr.useState)(null),u=G()(o,2),a=u[0],i=u[1],c=Object(Gr.useCallback)((function(e){if(!r||e.id===r){for(var o,u,a=arguments.length,c=new Array(a>1?a-1:0),l=1;l<a;l++)c[l-1]=arguments[l];if(i(t.apply(void 0,y()(o=[e]).call(o,c))),n)n.apply(void 0,y()(u=[e]).call(u,c))}}),[n,r]);return Jr(e,c),a}},eo=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(n,r){var o=Object(Gr.useCallback)((function(e){for(var o,u=arguments.length,a=new Array(u>1?u-1:0),i=1;i<u;i++)a[i-1]=arguments[i];return!n||t&&r&&e.id!==r?void 0:n.apply(void 0,y()(o=[e]).call(o,a))}),[n,r]);Jr(e,o)}},to=function(e,t){Object(O.isProduction)()||e||console.warn(t)},no=function(e){e[Kr]=!0},ro=function(e){var t,n;return!0===e[Kr]||!0===(null===(t=e.target)||void 0===t?void 0:t[Kr])||!0===(null===(n=e.render)||void 0===n?void 0:n[Kr])},oo=eo(nn.BATCH_ADD,!1),uo=eo(nn.BATCH_START),ao=eo(nn.BATCH_FINISH),io=eo(nn.BATCH_CANCEL),co=eo(nn.BATCH_ABORT),lo=$r(nn.BATCH_PROGRESS,(function(e){return P()({},e)})),so=eo(nn.ITEM_START),fo=eo(nn.ITEM_FINISH),po=eo(nn.ITEM_CANCEL),go=eo(nn.ITEM_ERROR),vo=eo(nn.ITEM_ABORT),ho=eo(nn.ITEM_FINALIZE),bo=$r(nn.ITEM_PROGRESS,(function(e){return P()({},e)})),So=eo(nn.REQUEST_PRE_SEND,!1),mo=eo(nn.ALL_ABORT,!1),Eo=function(e){var t=Zr();return e&&t.setOptions(e),t.getOptions()},To=function(){var e=Zr();return Object(Gr.useCallback)((function(t){return e.abort(t)}),[e])},Oo=function(){var e=Zr();return Object(Gr.useCallback)((function(t){return e.abortBatch(t)}),[e])},Io=function(){var e=Zr();return Object(Gr.useCallback)((function(){return e.abort()}),[e])},yo=function(e){var t=e.listeners,n=e.debug,r=e.children,o=e.inputRef,u=zr()(e,["listeners","debug","children","inputRef"]);O.logger.setDebug(!!n),O.logger.debugLog("@@@@@@ Uploady Rendering @@@@@@",e);var a=function(e,t){var n=Object(Gr.useMemo)((function(){return O.logger.debugLog("Uploady creating a new uploader instance",e),Gn(e)}),[e.enhancer]);return n.update(e),Object(Gr.useEffect)((function(){var e;t&&(O.logger.debugLog("Uploady setting event listeners",t),X()(e=K()(t)).call(e,(function(e){var t=G()(e,2),r=t[0],o=t[1];n.on(r,o)})));return function(){var e;t&&(O.logger.debugLog("Uploady removing event listeners",t),X()(e=K()(t)).call(e,(function(e){var t=G()(e,2),r=t[0],o=t[1];return n.off(r,o)})))}}),[t,n]),n}(u,t),i=Object(Gr.useMemo)((function(){return Xr(a,o)}),[a,o]);return Wr.a.createElement(Yr.Provider,{value:i},r)},Ao=function(e){return function(t){var n=Zr(),r=t.id,o=Object(Gr.useState)({update:null,data:null}),u=G()(o,2),a=u[0],i=u[1];return Object(Gr.useLayoutEffect)((function(){var e=function(t){var o;return Et()(o=t.items).call(o,(function(e){return e.id===r}))&&new le.a((function(r){i((function(){return{update:function(t){n.off(nn.REQUEST_PRE_SEND,e),r(t)},data:t}}))}))};return r&&n.on(nn.REQUEST_PRE_SEND,e),function(){r&&n.off(nn.REQUEST_PRE_SEND,e)}}),[n,r]),Wr.a.createElement(e,Mr()({},t,{updateRequest:a.update,requestData:a.data}))}},Lo=n("faye"),_o=n.n(Lo),Ro=function(e,t,n){return Wr.a.createElement("input",Mr()({},e,{name:t.inputFieldName,type:"file",ref:n}))},Co=Object(Gr.memo)(Object(Gr.forwardRef)((function(e,t){var n=e.container,r=e.noPortal,o=zr()(e,["container","noPortal"]),u=Eo(),a=n&&1===n.nodeType;return Object(O.invariant)(a||!Object(O.hasWindow)(),"Uploady - Container for file input must be a valid dom element"),r?Ro(o,u,t):function(e,t,n,r,o){return e&&t?_o.a.createPortal(Ro(n,r,o),e):null}(n,a,o,u,t)}))),Do=function(e){var t=e.multiple,n=void 0===t||t,r=e.capture,o=e.accept,u=e.webkitdirectory,a=e.children,i=e.inputFieldContainer,c=e.customInput,l=e.fileInputId,d=e.noPortal,s=void 0!==d&&d,f=zr()(e,["multiple","capture","accept","webkitdirectory","children","inputFieldContainer","customInput","fileInputId","noPortal"]),p=c?null:i||(Object(O.hasWindow)()?document.body:null),g=Object(Gr.useRef)();return Wr.a.createElement(yo,Mr()({},f,{inputRef:g}),c?null:Wr.a.createElement(Co,{container:p,multiple:n,capture:r,accept:o,webkitdirectory:u,style:{display:"none"},ref:g,id:l,noPortal:s}),a)},wo=n("pPxq"),Po=n.n(wo),Uo=function(e){var t=e.closest("form"),n={filesParamName:e.getAttribute("name"),method:void 0,url:void 0};if(t){var r,o=t.getAttribute("method"),u=function(e){var t,n,r,o,u,a,i,c,l=window.location,d=e.getAttribute("action")||"";switch(d=d.replace(/\s/g,""),!0){case""===d:d=l.href;break;case Po()(d).call(d,"/"):d=y()(t=y()(n="".concat(l.protocol,"//")).call(n,l.host)).call(t,d);break;case!/:\/\//.test(d):c=y()(r=D()(o=l.pathname.split("/")).call(o,0,-1)).call(r,"").join("/"),d=y()(u=y()(a=y()(i="".concat(l.protocol,"//")).call(i,l.host)).call(a,c)).call(u,d)}return d}(t);n.method=o?o.toUpperCase():void 0,n.url=u,O.logger.debugLog(y()(r="Uploady.useFileInput: using custom input's parent form url ".concat(n.url," and method ")).call(r,n.method||""))}return n},ko=function(e){var t=Zr();t.setExternalFileInput(e),Object(Gr.useEffect)((function(){if(e.current&&e.current.closest){var n=e.current,r=t.getOptions();if(!r.destination||!r.destination.url){var o=Uo(n);t.setOptions({destination:o})}}}),[e,t])},No=Do;to(ae||!Object(O.hasWindow)(),"This browser doesn't support chunking. Consider using @rpldy/uploady instead");var Fo=function(e){var t=e.chunked,n=e.chunkSize,r=e.retries,o=e.parallel,u=zr()(e,["chunked","chunkSize","retries","parallel"]),a=Object(Gr.useMemo)((function(){return ae?function(e,t){var n=nt(e);return t?zn(n,t):n}({chunked:t,chunkSize:n,retries:r,parallel:o},e.enhancer):void 0}),[e.enhancer,t,n,r,o]);return Wr.a.createElement(No,Mr()({},u,{enhancer:a}))},jo=eo(Me.CHUNK_START,!1),Bo=eo(Me.CHUNK_FINISH,!1),Ho=Fo,xo="Uploady - retry was not registered. Make sure you used the enhancer",Mo=function(){var e=Zr().getExtension(Wn);return Object(O.invariant)(e,xo),e.retry},qo=function(){var e=Zr().getExtension(Wn);return Object(O.invariant)(e,xo),e.retryBatch},zo=eo(Kn,!1),Go=Qn;to(ae,"This browser doesn't support chunking. Consider using @rpldy/uploady instead");var Wo=function(e){var t=e.chunked,n=e.chunkSize,r=e.retries,o=e.parallel,u=e.version,a=e.featureDetection,i=e.featureDetectionUrl,c=e.onFeaturesDetected,l=e.resume,d=e.deferLength,s=e.overrideMethod,f=e.sendDataOnCreate,p=e.storagePrefix,g=e.lockedRetryDelay,v=e.forgetOnSuccess,h=e.ignoreModifiedDateInStorage,b=zr()(e,["chunked","chunkSize","retries","parallel","version","featureDetection","featureDetectionUrl","onFeaturesDetected","resume","deferLength","overrideMethod","sendDataOnCreate","storagePrefix","lockedRetryDelay","forgetOnSuccess","ignoreModifiedDateInStorage"]),S=Object(Gr.useMemo)((function(){return ae?function(e,t){var n=Br(e);return t?zn(n,t):n}({chunked:t,chunkSize:n,retries:r,parallel:o,version:u,featureDetection:a,featureDetectionUrl:i,onFeaturesDetected:c,resume:l,deferLength:d,overrideMethod:s,sendDataOnCreate:f,storagePrefix:p,lockedRetryDelay:g,forgetOnSuccess:v,ignoreModifiedDateInStorage:h},e.enhancer):void 0}),[e.enhancer,t,n,r,o,u,a,i,c,l,d,s,f,p,g,v,h]);return Wr.a.createElement(No,Mr()({},b,{enhancer:S}))},Ko=function(){var e=Zr().getExtension(dr);return Object(O.invariant)(e,"Uploady - tus was not registered. Make sure you used the enhancer"),function(){return ir(e.getOptions())}},Vo=Wo,Xo=function(e){var t=function(t,n){var r=Zr().showFileUpload,o=t.id,u=t.className,a=t.text,i=t.children,c=t.extraProps,l=t.onClick,d=zr()(t,["id","className","text","children","extraProps","onClick"]),s=Object(Gr.useRef)();s.current=d;var f=Object(Gr.useCallback)((function(e){r(s.current),null==l||l(e)}),[r,s,l]);return Wr.a.createElement(e,Mr()({ref:n,onClick:f,id:o,className:u,children:i||a||"Upload"},c))};return no(t),Object(Gr.forwardRef)(t)},Yo=Xo(Object(Gr.forwardRef)((function(e,t){return Wr.a.createElement("button",Mr()({ref:t},e))}))),Qo=Yo,Zo=n("ALC1"),Jo=Object(Gr.forwardRef)((function(e,t){var n=Object(Gr.useRef)(null);Object(Gr.useImperativeHandle)(t,(function(){return n.current}),[]);var r=Zr().upload,o=e.className,u=e.id,a=e.children,i=e.onDragOverClassName,c=e.dropHandler,l=e.htmlDirContentParams,d=e.extraProps,s=zr()(e,["className","id","children","onDragOverClassName","dropHandler","htmlDirContentParams","extraProps"]),f=Object(Gr.useRef)();f.current=s;var p=Object(Gr.useCallback)((function(){n.current&&i&&n.current.classList.remove(i)}),[i,n]),g=Object(Gr.useCallback)((function(e){return c?le.a.resolve(c(e)):Object(Zo.getFilesFromDragEvent)(e,l||{})}),[c,l]),v=Object(Gr.useCallback)((function(e){g(e).then((function(e){r(e,f.current)}))}),[r,g,f]),h=Object(Gr.useCallback)((function(e){e.preventDefault(),n.current&&i&&n.current.classList.add(i)}),[i,n]),b=Object(Gr.useCallback)((function(e){e.preventDefault(),e.persist(),p(),v(e)}),[p,v]),S=Object(Gr.useCallback)((function(){p()}),[p]),m=Object(Gr.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),p()}),[p]);return Wr.a.createElement("div",Mr()({id:u,className:o,ref:n,onDragOver:h,onDrop:b,onDragLeave:S,onDragEnd:m},d),a)}));no(Jo);var $o=Jo,eu=$o,tu=function(e,t){var n=Zr().upload,r=Object(Gr.useRef)();return r.current=e,Object(Gr.useCallback)((function(e){var o,u=null===(o=e.clipboardData)||void 0===o?void 0:o.files;(null==u?void 0:u.length)&&(n(u,r.current),null==t||t({count:u.length}))}),[n,r,t])},nu=function(e){return Object(Gr.forwardRef)((function(t,n){var r=t.id,o=t.className,u=t.children,a=t.onPasteUpload,i=t.extraProps,c=zr()(t,["id","className","children","onPasteUpload","extraProps"]),l=tu(c,a),d=ro(e)?P()(P()({},c),{},{extraProps:P()(P()({},i),{},{onPaste:l})}):P()(P()({},i),{},{onPaste:l});return Wr.a.createElement(e,Mr()({ref:n,id:r,className:o},d),u)}))},ru=function(e,t){((null==e?void 0:e.current)||window).addEventListener("paste",t)},ou=function(e,t){((null==e?void 0:e.current)||window).removeEventListener("paste",t)},uu=function(e,t,n){var r=Object(Gr.useRef)(!0),o=tu(e,n),u=Object(Gr.useCallback)((function(){return r.current=!r.current,r.current?ru(t,o):ou(t,o),r.current}),[t,o]),a=Object(Gr.useCallback)((function(){return r.current}),[]);return Object(Gr.useEffect)((function(){return r.current&&ru(t,o),function(){r.current&&ou(t,o)}}),[t,o]),{toggle:u,getIsEnabled:a}},au=nu,iu={IMAGE:"image",VIDEO:"video"},cu=n("R8cT"),lu=n.n(cu),du=Object(O.devFreeze)({rememberPreviousBatches:!1,loadFirstOnly:!1,maxPreviewImageSize:2e7,maxPreviewVideoSize:1e8,fallbackUrl:"",imageMimeTypes:["image/jpeg","image/webp","image/gif","image/png","image/apng","image/bmp","image/x-icon","image/svg+xml"],videoMimeTypes:["video/mp4","video/webm","video/ogg"],previewComponentProps:void 0}),su=function(e,t){var n=Object(O.isFunction)(e)?e(t):e;return"string"==typeof n&&(n={id:"",url:n,name:t.name,type:iu.IMAGE}),n},fu=function(e,t,n,r){var o;return t&&~L()(t).call(t,r.type)&&(!n||r.size<=n)&&(o={url:lu.a.createObjectURL(r),name:r.name,type:e}),o},pu=function(e,t,n){var r,o,u=!1;if(e.file){var a=e.file;(r=function(e,t){var n=fu(iu.IMAGE,t.imageMimeTypes,t.maxPreviewImageSize||0,e);return n||(n=fu(iu.VIDEO,t.videoMimeTypes,t.maxPreviewVideoSize||0,e)),n}(e.file,t))||(r=su(t.fallbackUrl,a),u=!0)}else r={url:e.url,name:e.url,type:iu.IMAGE};return r&&(o=Object(O.isFunction)(n)?n(e,r.url,r.type):n),r&&P()(P()({},r),{},{id:e.id,isFallback:u,props:o})},gu=function(e){var t,n=Object(Gr.useState)([]),r=G()(n,2),o=r[0],u=r[1],a=(t=e,P()(P()({},du),t)),i=Object(Gr.useCallback)((function(){u([])}),[]);return uo((function(t){var n,r,i,c,l,d=a.loadFirstOnly?D()(n=t.items).call(n,0,1):t.items,s=ft()(r=be()(d).call(d,(function(t){return pu(t,a,e.previewComponentProps)}))).call(r,Boolean);u(e.rememberPreviousBatches?(i=o,c=s,l=[],X()(c).call(c,(function(e){var t=Oe()(i).call(i,(function(t){return t.id===e.id}));~t?Ee()(i).call(i,t,1,e):l.push(e)})),y()(i).call(i,l)):s)})),{previews:o,clearPreviews:i}},vu=function(e){var t=e.PreviewComponent,n=e.previewMethodsRef,r=e.onPreviewsChanged,o=zr()(e,["PreviewComponent","previewMethodsRef","onPreviewsChanged"]),u=gu(o),a=u.previews,i=u.clearPreviews,c=Object(Gr.useCallback)((function(t){var n=t.target,r=su(e.fallbackUrl,n.src);r&&(n.src=r.url)}),[e.fallbackUrl]);return function(e,t,n,r){Object(Gr.useImperativeHandle)(n,(function(){return{clear:t}}),[t]),Object(Gr.useEffect)((function(){r&&r(e)}),[e,r])}(a,i,n,r),be()(a).call(a,(function(e){var n=e.id,r=e.url,o=e.type,u=e.name,a=e.isFallback,i=e.props;return t?Wr.a.createElement(t,Mr()({key:n+r,id:n,url:r,type:o,name:u,isFallback:a},i)):function(e,t,n,r){return e===iu.VIDEO?Wr.a.createElement("video",Mr()({key:t,src:t,controls:!0},n)):Wr.a.createElement("img",Mr()({key:t,onError:r,src:t},n))}(o,r,i,c)}))},hu=vu,bu=Object(Gr.forwardRef)((function(e,t){var n=Object(Gr.useRef)(null),r=Zr(),o=e.className,u=e.id,a=e.placeholder,i=e.uploadRef,c=e.validate,l=e.ignoreKeyPress,d=zr()(e,["className","id","placeholder","uploadRef","validate","ignoreKeyPress"]),s=Object(Gr.useRef)();s.current=d,Object(Gr.useImperativeHandle)(t,(function(){return n.current}),[]);var f=Object(Gr.useCallback)((function(){var e=n.current,t=null==e?void 0:e.value;(c?c(t,e):t)&&r.upload(t,s.current)}),[r,c,s,n]),p=Object(Gr.useCallback)((function(e){l||"Enter"!==e.key||f()}),[f,l]);return Object(Gr.useImperativeHandle)(i,(function(){return f}),[f]),Wr.a.createElement("input",{type:"text",id:u,ref:n,className:o,onKeyPress:p,placeholder:a})}));no(bu);var Su=bu,mu=bu},VPmE:function(e,t,n){"use strict";n.d(t,"e",(function(){return o.a})),n.d(t,"h",(function(){return s})),n.d(t,"b",(function(){return v})),n.d(t,"i",(function(){return P})),n.d(t,"c",(function(){return w})),n.d(t,"a",(function(){return U})),n.d(t,"j",(function(){return B})),n.d(t,"f",(function(){return R})),n.d(t,"d",(function(){return H.a})),n.d(t,"g",(function(){return g.a}));var r=n("r5yn"),o=n.n(r),u=n("/FZm"),a=n.n(u),i=n("FLGM"),c=n.n(i),l=n("o+MX"),d=n.n(l),s=function(e,t,n){var r=!0,o=function(e){var t,n=d()(t=[]).call(t,e);return function(e){return c()(e).call(e,(function(e){return c()(n).call(n,(function(t){return e[t]})).join()}))}}(n);if(e&&t&&e.length===t.length){var u=o(e),i=o(t);r=!!a()(u).call(u,(function(e,t){return e!==i[t]}))}return!r},f=n("9yv6"),p=n.n(f),g=n("DVTP"),v=function(e){return Object(g.a)()?e:p()(e)},h=n("RXMP"),b=n.n(h),S=n("OWCx"),m=n.n(S),E=n("+oHS"),T=n.n(E),O=n("6UaR"),I=n.n(O),y=n("zKQ6"),A=n.n(y),L=n("nhkr"),_=n.n(L),R=function(e){var t;return!!e&&"object"===_()(e)&&("Object"===(null===(t=A()(e))||void 0===t?void 0:t.constructor.name)||null===A()(e))},C=function(e){return R(e)||I()(e)},D=function(e,t){var n=T()(e);return t.withSymbols?d()(n).call(n,m()(e)):n},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),u=1;u<r;u++)o[u-1]=arguments[u];return n&&o.length&&b()(o).call(o,(function(r){var o;r&&b()(o=D(r,e)).call(o,(function(o){var u=r[o];e.predicate&&!e.predicate(o,u)||(void 0!==u||e.undefinedOverwrites)&&(C(u)?(void 0!==n[o]&&R(n[o])||(n[o]=I()(u)?[]:{}),t(n[o],u)):n[o]=u)}))})),n};return t},P=w(),U=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P;return C(e)?t(I()(e)?[]:{},e):e},k=n("ZbhI"),N=n.n(k),F=n("KYsz"),j=n.n(F),B=function(e,t){var n;return e&&j()(n=T()(e)).call(n,(function(n,r){return~N()(t).call(t,r)&&(n[r]=e[r]),n}),{})},H=n("n5N2")},cDcd:function(t,n){t.exports=e},faye:function(e,n){e.exports=t},"mHo/":function(e,t,n){"use strict";n.r(t),n.d(t,"BATCH_STATES",(function(){return i.a})),n.d(t,"FILE_STATES",(function(){return i.c})),n.d(t,"invariant",(function(){return o.a})),n.d(t,"throttle",(function(){return a.a})),n.d(t,"logger",(function(){return c})),n.d(t,"triggerCancellable",(function(){return v})),n.d(t,"triggerUpdater",(function(){return b})),n.d(t,"createBatchItem",(function(){return R})),n.d(t,"request",(function(){return q})),n.d(t,"parseResponseHeaders",(function(){return M})),n.d(t,"isFunction",(function(){return z.e})),n.d(t,"isPlainObject",(function(){return z.f})),n.d(t,"isSamePropInArrays",(function(){return z.h})),n.d(t,"devFreeze",(function(){return z.b})),n.d(t,"merge",(function(){return z.i})),n.d(t,"getMerge",(function(){return z.c})),n.d(t,"clone",(function(){return z.a})),n.d(t,"pick",(function(){return z.j})),n.d(t,"hasWindow",(function(){return z.d})),n.d(t,"isProduction",(function(){return z.g}));var r=n("kvau"),o=n.n(r),u=n("uDTZ"),a=n.n(u),i=n("10TY"),c=n("ytft"),l=n("TEMH"),d=n.n(l),s=n("o+MX"),f=n.n(s),p=n("OBge"),g=n.n(p),v=function(e,t){for(var n,r=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return new g.a((function(n,o){var u,a=e.apply(void 0,f()(u=[t]).call(u,r));a&&a.length?g.a.all(a).catch(o).then((function(e){return e&&n(!!~d()(e).call(e,(function(e){return!1===e})))})):n(!1)}))},o=arguments.length,u=new Array(o>2?o-2:0),a=2;a<o;a++)u[a-2]=arguments[a];return t?r.apply(void 0,f()(n=[t]).call(n,u)):r},h=function(e){return null==e},b=function(e,t){for(var n,r=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return new g.a((function(n,o){var u,a=e.apply(void 0,f()(u=[t]).call(u,r));a&&a.length?g.a.all(a).catch(o).then((function(e){var t;if(e)for(;h(t)&&e.length;)t=e.pop();n(h(t)?void 0:t)})):n()}))},o=arguments.length,u=new Array(o>2?o-2:0),a=2;a<o;a++)u[a-2]=arguments[a];return t?r.apply(void 0,f()(n=[t]).call(n,u)):r},S=n("LYCE"),m=n.n(S),E=n("nhkr"),T=n.n(E),O=n("CtDf"),I=n.n(O)()("__rpldy-bi__"),y=0,A=function(e,t){return e.url=t,e},L=function(e,t){return e.file=t,e},_=function(e){return e&&(e instanceof Blob||e instanceof File||"object"===T()(e)&&e.name&&e.type)},R=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];y+=e.id&&e.batchId?0:1;var o=e.id&&e.batchId?e.id:f()(n="".concat(t,".item-")).call(n,y),u=r?i.c.PENDING:i.c.ADDED,a={id:o,batchId:t,state:u,uploadStatus:0,completed:0,loaded:0,aborted:!1,recycled:!1,previousBatch:null};if(m()(a,I,{value:!0,writable:!0}),"object"===T()(e)&&!0===e[I]&&(a.recycled=!0,a.previousBatch=e.batchId,e=e.file||e.url),"string"==typeof e)a=A(a,e);else{if(!_(e))throw new Error("Unknown type of file added: ".concat(T()(e)));a=L(a,e)}return a},C=n("+oHS"),D=n.n(C),w=n("RXMP"),P=n.n(w),U=function(e,t){var n;t&&P()(n=D()(t)).call(n,(function(n){void 0!==t[n]&&e.setRequestHeader(n,t[n])}))},k=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new XMLHttpRequest,o=new g.a((function(o,u){r.onerror=function(){return u(r)},r.ontimeout=function(){return u(r)},r.onabort=function(){return u(r)},r.onload=function(){return o(r)},r.open(n.method||"GET",e),U(r,n.headers),r.withCredentials=!!n.withCredentials,n.preSend&&n.preSend(r),r.send(t)}));return o.xhr=r,o},N=n("zLi2"),F=n.n(N),j=n("RKTd"),B=n.n(j),H=n("KYsz"),x=n.n(H),M=function(e){var t;try{var n,r;t=x()(n=B()(r=e.getAllResponseHeaders()).call(r).split(/[\r\n]+/)).call(n,(function(e,t){var n=t.split(": "),r=F()(n,2),o=r[0],u=r[1];return e[o]=u,e}),{})}catch(t){Object(c.debugLog)("uploady.request: failed to read response headers",e)}return t},q=k,z=n("VPmE")},n5N2:function(e,t,n){"use strict";var r=n("nhkr"),o=n.n(r);t.a=function(){return"object"===("undefined"==typeof window?"undefined":o()(window))&&!!window.document}},r5yn:function(e,t){e.exports=function(e){return"function"==typeof e}},ytft:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"isDebugOn",(function(){return l})),n.d(t,"setDebug",(function(){return d})),n.d(t,"debugLog",(function(){return s}));var r,o=n("ZbhI"),u=n.n(o),a=n("10TY"),i=n("n5N2"),c=n("VPmE"),l=function(){var t,n,o;"boolean"!=typeof r&&(r=!Object(c.g)()&&(null===(n=e)||void 0===n||null===(o=n.env)||void 0===o?void 0:o.DEBUG)||Object(i.a)()&&("location"in window&&!!~u()(t=window.location.search).call(t,"rpldy_debug=true")||!0===window[a.b]));return r},d=function(e){Object(i.a)()&&(window[a.b]=e),r=!!e||null},s=function(){var e;l()&&(e=console).log.apply(e,arguments)}}.call(this,n("8oxB"))}})}));
//# sourceMappingURL=rpldy-all.umd.min.js.map